
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modeling distributions &#8212; Think Stats, 3rd edition</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap05';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Probability density functions" href="chap06.html" />
    <link rel="prev" title="Cumulative distribution functions" href="chap04.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Think Stats, 3rd edition</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Think Stats, 3rd edition
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap00.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap01.html">Exploratory data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">Probability mass functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">Cumulative distribution functions</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Modeling distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">Probability density functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">Relationships between variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">Hypothesis testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">Linear least squares</a></li>

<li class="toctree-l1"><a class="reference internal" href="chap11.html">Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap12.html">Time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap13.html">Survival analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap14.html">Analytic methods</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ThinkStats/tree/v3" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap05.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modeling distributions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-exponential-distribution">The exponential distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-normal-distribution">The normal distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-probability-plot">Normal probability plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lognormal-distribution">The lognormal distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pareto-distribution">The Pareto distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-random-numbers">Generating random numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-model">Why model?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Exercise</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="modeling-distributions">
<h1>Modeling distributions<a class="headerlink" href="#modeling-distributions" title="Link to this heading">#</a></h1>
<p>The distributions we have used so far are called <strong>empirical
distributions</strong> because they are based on empirical observations, which
are necessarily finite samples.</p>
<p>The alternative is an <strong>analytic distribution</strong>, which is characterized
by a CDF that is a mathematical function. Analytic distributions can be
used to model empirical distributions. In this context, a <strong>model</strong> is a
simplification that leaves out unneeded details. This chapter presents
common analytic distributions and uses them to model data from a variety
of sources.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>


<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>

        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloaded &quot;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>


<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/nb/thinkstats.py&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/nb/thinkplot.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 2;
                var nbb_unformatted_code = "from os.path import basename, exists\n\n\ndef download(url):\n    filename = basename(url)\n    if not exists(filename):\n        from urllib.request import urlretrieve\n\n        local, _ = urlretrieve(url, filename)\n        print(\"Downloaded \" + local)\n\n\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/thinkstats.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/thinkplot.py\")";
                var nbb_formatted_code = "from os.path import basename, exists\n\n\ndef download(url):\n    filename = basename(url)\n    if not exists(filename):\n        from urllib.request import urlretrieve\n\n        local, _ = urlretrieve(url, filename)\n        print(\"Downloaded \" + local)\n\n\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/thinkstats.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/thinkplot.py\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">decorate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "import numpy as np\nimport matplotlib.pyplot as plt\nfrom thinkstats import decorate";
                var nbb_formatted_code = "import numpy as np\nimport matplotlib.pyplot as plt\nfrom thinkstats import decorate";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<section id="the-exponential-distribution">
<h2>The exponential distribution<a class="headerlink" href="#the-exponential-distribution" title="Link to this heading">#</a></h2>
<p>I’ll start with the <strong>exponential distribution</strong> because it is
relatively simple. The CDF of the exponential distribution is
$<span class="math notranslate nohighlight">\(CDF(x) = 1 - e^{-\lambda x}\)</span><span class="math notranslate nohighlight">\( The parameter, \)</span>\lambda$, determines
the shape of the distribution.</p>
<p>The following figure shows what this CDF looks like with <span class="math notranslate nohighlight">\(\lambda =\)</span> 0.5, 1, and 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">render_expo_cdf</span>

<span class="k">for</span> <span class="n">lam</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]:</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">render_expo_cdf</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">lambda=</span><span class="si">%g</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="n">lam</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Exponential CDF&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/24485c75d916e76b5e586770c5916491e72b2eca8e0833f6141d13e688107a95.png" src="_images/24485c75d916e76b5e586770c5916491e72b2eca8e0833f6141d13e688107a95.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "from thinkstats import render_expo_cdf\n\nfor lam in [2.0, 1, 0.5]:\n    xs, ps = render_expo_cdf(lam, 0, 3.0, 50)\n    label = \"$\\\\lambda=%g$\" % lam\n    plt.plot(xs, ps, label=label)\ndecorate(title=\"Exponential CDF\", xlabel=\"x\", ylabel=\"CDF\", loc=\"lower right\")";
                var nbb_formatted_code = "from thinkstats import render_expo_cdf\n\nfor lam in [2.0, 1, 0.5]:\n    xs, ps = render_expo_cdf(lam, 0, 3.0, 50)\n    label = \"$\\\\lambda=%g$\" % lam\n    plt.plot(xs, ps, label=label)\ndecorate(title=\"Exponential CDF\", xlabel=\"x\", ylabel=\"CDF\", loc=\"lower right\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>In the real world, exponential distributions come up when we look at a
series of events and measure the times between events, called
<strong>interarrival times</strong>. If the events are equally likely to occur at any
time, the distribution of interarrival times tends to look like an
exponential distribution.</p>
<p>As an example, we will look at the interarrival time of births. On
December 18, 1997, 44 babies were born in a hospital in Brisbane,
Australia.[^1] The time of birth for all 44 babies was reported in the
local paper; the complete dataset is in a file called <code class="docutils literal notranslate"><span class="pre">babyboom.dat</span></code>, in
the <code class="docutils literal notranslate"><span class="pre">ThinkStats2</span></code> repository.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/data/babyboom.dat&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/babyboom.dat\")";
                var nbb_formatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/babyboom.dat\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">read_baby_boom</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">read_baby_boom</span><span class="p">()</span>
<span class="n">diffs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">minutes</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "from thinkstats import read_baby_boom\n\ndf = read_baby_boom()\ndiffs = df.minutes.diff()";
                var nbb_formatted_code = "from thinkstats import read_baby_boom\n\ndf = read_baby_boom()\ndiffs = df.minutes.diff()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">empiricaldist</span> <span class="kn">import</span> <span class="n">Cdf</span>

<span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;actual&quot;</span><span class="p">)</span>
<span class="n">cdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;minutes&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/64e58f6647ce43e66a6ea5f649a8cfce1b4b4b2dae37045391aecea8beac63e3.png" src="_images/64e58f6647ce43e66a6ea5f649a8cfce1b4b4b2dae37045391aecea8beac63e3.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "from empiricaldist import Cdf\n\ncdf = Cdf.from_seq(diffs, name=\"actual\")\ncdf.plot()\ndecorate(xlabel=\"minutes\", ylabel=\"CDF\")";
                var nbb_formatted_code = "from empiricaldist import Cdf\n\ncdf = Cdf.from_seq(diffs, name=\"actual\")\ncdf.plot()\ndecorate(xlabel=\"minutes\", ylabel=\"CDF\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ReadBabyBoom</span></code> reads the data file and returns a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with columns
<code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">sex</span></code>, <code class="docutils literal notranslate"><span class="pre">weight_g</span></code>, and <code class="docutils literal notranslate"><span class="pre">minutes</span></code>, where <code class="docutils literal notranslate"><span class="pre">minutes</span></code> is time of
birth converted to minutes since midnight.</p>
<p><code class="docutils literal notranslate"><span class="pre">diffs</span></code> is the difference between consecutive birth times, and <code class="docutils literal notranslate"><span class="pre">cdf</span></code> is
the distribution of these interarrival times.
The following figure (left) shows the CDF. It seems to
have the general shape of an exponential distribution, but how can we
tell?</p>
<p>One way is to plot the <strong>complementary CDF</strong>, which is <span class="math notranslate nohighlight">\(1 - CDF(x)\)</span>, on
a log-y scale. For data from an exponential distribution, the result is
a straight line. Let’s see why that works.</p>
<p>If you plot the complementary CDF (CCDF) of a dataset that you think is
exponential, you expect to see a function like:
$<span class="math notranslate nohighlight">\(y \approx e^{-\lambda x}\)</span><span class="math notranslate nohighlight">\( Taking the log of both sides yields:
\)</span><span class="math notranslate nohighlight">\(\log y \approx -\lambda x\)</span><span class="math notranslate nohighlight">\( So on a log-y scale the CCDF is a straight
line with slope \)</span>-\lambda$. Here’s how we can generate a plot like that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;minutes&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bb2faed2d3131298791536f34366c8f41a2231da3e2494ca13e6e722c5846889.png" src="_images/bb2faed2d3131298791536f34366c8f41a2231da3e2494ca13e6e722c5846889.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "(1-cdf).plot()\ndecorate(xlabel=\"minutes\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_formatted_code = "(1 - cdf).plot()\ndecorate(xlabel=\"minutes\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>With the argument <code class="docutils literal notranslate"><span class="pre">complement=True</span></code>, <code class="docutils literal notranslate"><span class="pre">thinkplot.Cdf</span></code> computes the
complementary CDF before plotting. And with <code class="docutils literal notranslate"><span class="pre">yscale='log'</span></code>,
<code class="docutils literal notranslate"><span class="pre">thinkplot.Show</span></code> sets the <code class="docutils literal notranslate"><span class="pre">y</span></code> axis to a logarithmic scale.</p>
<p>The following figure (right) shows the result. It is
not exactly straight, which indicates that the exponential distribution
is not a perfect model for this data. Most likely the underlying
assumption—that a birth is equally likely at any time of day—is not
exactly true. Nevertheless, it might be reasonable to model this dataset
with an exponential distribution. With that simplification, we can
summarize the distribution with a single parameter.</p>
<p>The parameter, <span class="math notranslate nohighlight">\(\lambda\)</span>, can be interpreted as a rate; that is, the
number of events that occur, on average, in a unit of time. In this
example, 44 babies are born in 24 hours, so the rate is <span class="math notranslate nohighlight">\(\lambda =
0.0306\)</span> births per minute. The mean of an exponential distribution is
<span class="math notranslate nohighlight">\(1/\lambda\)</span>, so the mean time between births is 32.7 minutes.</p>
</section>
<section id="the-normal-distribution">
<h2>The normal distribution<a class="headerlink" href="#the-normal-distribution" title="Link to this heading">#</a></h2>
<p>The <strong>normal distribution</strong>, also called Gaussian, is commonly used
because it describes many phenomena, at least approximately. It turns
out that there is a good reason for its ubiquity, which we will get to
in Section <a class="reference internal" href="#CLT"><span class="xref myst">[CLT]</span></a>{reference-type=“ref” reference=“CLT”}.</p>
<p>The normal distribution is characterized by two parameters: the mean,
<span class="math notranslate nohighlight">\(\mu\)</span>, and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>. The normal distribution with
<span class="math notranslate nohighlight">\(\mu=0\)</span> and <span class="math notranslate nohighlight">\(\sigma=1\)</span> is called the <strong>standard normal distribution</strong>.
Its CDF is defined by an integral that does not have a closed form
solution, but there are algorithms that evaluate it efficiently. One of
them is provided by SciPy: <code class="docutils literal notranslate"><span class="pre">scipy.stats.norm</span></code> is an object that
represents a normal distribution; it provides a method, <code class="docutils literal notranslate"><span class="pre">cdf</span></code>, that
evaluates the standard normal CDF:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span>

<span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "import scipy.stats\n\nscipy.stats.norm.cdf(0)";
                var nbb_formatted_code = "import scipy.stats\n\nscipy.stats.norm.cdf(0)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>This result is correct: the median of the standard normal distribution
is 0 (the same as the mean), and half of the values fall below the
median, so <span class="math notranslate nohighlight">\(CDF(0)\)</span> is 0.5.</p>
<p><code class="docutils literal notranslate"><span class="pre">norm.cdf</span></code> takes optional parameters: <code class="docutils literal notranslate"><span class="pre">loc</span></code>, which specifies the mean,
and <code class="docutils literal notranslate"><span class="pre">scale</span></code>, which specifies the standard deviation.</p>
<p><code class="docutils literal notranslate"><span class="pre">thinkstats2</span></code> makes this function a little easier to use by providing
<code class="docutils literal notranslate"><span class="pre">EvalNormalCdf</span></code>, which takes parameters <code class="docutils literal notranslate"><span class="pre">mu</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma</span></code> and evaluates
the CDF at <code class="docutils literal notranslate"><span class="pre">x</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eval_normal_cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "def eval_normal_cdf(x, mu=0, sigma=1):\n    return scipy.stats.norm.cdf(x, loc=mu, scale=sigma)";
                var nbb_formatted_code = "def eval_normal_cdf(x, mu=0, sigma=1):\n    return scipy.stats.norm.cdf(x, loc=mu, scale=sigma)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>The following figure shows CDFs for normal distributions
with a range of parameters. The sigmoid shape of these curves is a
recognizable characteristic of a normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">render_normal_cdf</span>

<span class="n">mus</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="n">sigmas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mus</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">):</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">render_normal_cdf</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">low</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mu=</span><span class="si">%g</span><span class="s2">$, $</span><span class="se">\\</span><span class="s2">sigma=</span><span class="si">%g</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Normal CDF&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6530219c4e36b3007ce6530a33fd636022b43b25b2dc2f3316dbde14ae14a022.png" src="_images/6530219c4e36b3007ce6530a33fd636022b43b25b2dc2f3316dbde14ae14a022.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 16;
                var nbb_unformatted_code = "from thinkstats import render_normal_cdf\n\nmus = [1.0, 2.0, 3.0]\nsigmas = [0.5, 0.4, 0.3]\nfor mu, sigma in zip(mus, sigmas):\n    xs, ps = render_normal_cdf(mu=mu, sigma=sigma, low=-1.0, high=4.0)\n    label = \"$\\\\mu=%g$, $\\\\sigma=%g$\" % (mu, sigma)\n    plt.plot(xs, ps, label=label)\ndecorate(title=\"Normal CDF\", xlabel=\"x\", ylabel=\"CDF\", loc=\"upper left\")";
                var nbb_formatted_code = "from thinkstats import render_normal_cdf\n\nmus = [1.0, 2.0, 3.0]\nsigmas = [0.5, 0.4, 0.3]\nfor mu, sigma in zip(mus, sigmas):\n    xs, ps = render_normal_cdf(mu=mu, sigma=sigma, low=-1.0, high=4.0)\n    label = \"$\\\\mu=%g$, $\\\\sigma=%g$\" % (mu, sigma)\n    plt.plot(xs, ps, label=label)\ndecorate(title=\"Normal CDF\", xlabel=\"x\", ylabel=\"CDF\", loc=\"upper left\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>In the previous chapter we looked at the distribution of birth weights
in the NSFG.
The following figure shows the empirical CDF of weights
for all live births and the CDF of a normal distribution with the same
mean and variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/nb/nsfg.py&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/data/2002FemPreg.dct&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/data/2002FemPreg.dat.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 18;
                var nbb_unformatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/nsfg.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/2002FemPreg.dct\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/2002FemPreg.dat.gz\")";
                var nbb_formatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/nsfg.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/2002FemPreg.dct\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/2002FemPreg.dat.gz\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nsfg</span>

<span class="n">preg</span> <span class="o">=</span> <span class="n">nsfg</span><span class="o">.</span><span class="n">read_fem_preg</span><span class="p">()</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">preg</span><span class="o">.</span><span class="n">totalwgt_lb</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 19;
                var nbb_unformatted_code = "import nsfg\n\npreg = nsfg.read_fem_preg()\nweights = preg.totalwgt_lb.dropna()";
                var nbb_formatted_code = "import nsfg\n\npreg = nsfg.read_fem_preg()\nweights = preg.totalwgt_lb.dropna()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">trimmed_mean_var</span>

<span class="n">mu</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">trimmed_mean_var</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean, Var&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean, Var 7.280883100022579 1.5452125703544901
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 20;
                var nbb_unformatted_code = "from thinkstats import trimmed_mean_var\n\nmu, var = trimmed_mean_var(weights, p=0.01)\nprint(\"Mean, Var\", mu, var)";
                var nbb_formatted_code = "from thinkstats import trimmed_mean_var\n\nmu, var = trimmed_mean_var(weights, p=0.01)\nprint(\"Mean, Var\", mu, var)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sigma&quot;</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sigma 1.2430657948614345
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 21;
                var nbb_unformatted_code = "sigma = np.sqrt(var)\nprint(\"Sigma\", sigma)";
                var nbb_formatted_code = "sigma = np.sqrt(var)\nprint(\"Sigma\", sigma)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">render_normal_cdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">12.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.6&quot;</span><span class="p">)</span>

<span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">cdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Birth weights&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Birth weight (pounds)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/59d5498161ea5ff8ef2d203039fe7034a446fadef25678b36330e3da37994b08.png" src="_images/59d5498161ea5ff8ef2d203039fe7034a446fadef25678b36330e3da37994b08.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 24;
                var nbb_unformatted_code = "xs, ps = render_normal_cdf(mu, sigma, low=0, high=12.5)\nplt.plot(xs, ps, label=\"model\", color=\"0.6\")\n\ncdf = Cdf.from_seq(weights, name=\"data\")\ncdf.plot()\n\ndecorate(title=\"Birth weights\", xlabel=\"Birth weight (pounds)\", ylabel=\"CDF\")";
                var nbb_formatted_code = "xs, ps = render_normal_cdf(mu, sigma, low=0, high=12.5)\nplt.plot(xs, ps, label=\"model\", color=\"0.6\")\n\ncdf = Cdf.from_seq(weights, name=\"data\")\ncdf.plot()\n\ndecorate(title=\"Birth weights\", xlabel=\"Birth weight (pounds)\", ylabel=\"CDF\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>The normal distribution is a good model for this dataset, so if we
summarize the distribution with the parameters <span class="math notranslate nohighlight">\(\mu = 7.28\)</span> and
<span class="math notranslate nohighlight">\(\sigma = 1.24\)</span>, the resulting error (difference between the model and
the data) is small.</p>
<p>Below the 10th percentile there is a discrepancy between the data and
the model; there are more light babies than we would expect in a normal
distribution. If we are specifically interested in preterm babies, it
would be important to get this part of the distribution right, so it
might not be appropriate to use the normal model.</p>
</section>
<section id="normal-probability-plot">
<h2>Normal probability plot<a class="headerlink" href="#normal-probability-plot" title="Link to this heading">#</a></h2>
<p>For the exponential distribution, and a few others, there are simple
transformations we can use to test whether an analytic distribution is a
good model for a dataset.</p>
<p>For the normal distribution there is no such transformation, but there
is an alternative called a <strong>normal probability plot</strong>. There are two
ways to generate a normal probability plot: the hard way and the easy
way. If you are interested in the hard way, you can read about it at
<a class="reference external" href="https://en.wikipedia.org/wiki/Normal_probability_plot">https://en.wikipedia.org/wiki/Normal_probability_plot</a>. Here’s the easy
way:</p>
<ol class="arabic simple">
<li><p>Sort the values in the sample.</p></li>
<li><p>From a standard normal distribution (<span class="math notranslate nohighlight">\(\mu=0\)</span> and <span class="math notranslate nohighlight">\(\sigma=1\)</span>),
generate a random sample with the same size as the sample, and sort
it.</p></li>
<li><p>Plot the sorted values from the sample versus the random values.</p></li>
</ol>
<p>If the distribution of the sample is approximately normal, the result is
a straight line with intercept <code class="docutils literal notranslate"><span class="pre">mu</span></code> and slope <code class="docutils literal notranslate"><span class="pre">sigma</span></code>. <code class="docutils literal notranslate"><span class="pre">thinkstats2</span></code>
provides <code class="docutils literal notranslate"><span class="pre">normal_probability</span></code>, which takes a sample and returns two NumPy
arrays:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">normal_probability</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 25;
                var nbb_unformatted_code = "from thinkstats import normal_probability";
                var nbb_formatted_code = "from thinkstats import normal_probability";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ys</span></code> contains the sorted values from <code class="docutils literal notranslate"><span class="pre">sample</span></code>; <code class="docutils literal notranslate"><span class="pre">xs</span></code> contains the random
values from the standard normal distribution.</p>
<p>To test <code class="docutils literal notranslate"><span class="pre">normal_probability</span></code> I generated some fake samples that were
actually drawn from normal distributions with various parameters.
The following figure shows the results. The lines
are approximately straight, with values in the tails deviating more than
values near the mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">mus</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">sigmas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="k">for</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mus</span><span class="p">,</span> <span class="n">sigmas</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">normal_probability</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">mu=</span><span class="si">%d</span><span class="s2">$, $</span><span class="se">\\</span><span class="s2">sigma=</span><span class="si">%d</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Normal probability plot&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;standard normal sample&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;sample values&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e00258fcba4d8cc55f1f867125e71b1f58b6587da1a196c4f979c5266f0decd0.png" src="_images/e00258fcba4d8cc55f1f867125e71b1f58b6587da1a196c4f979c5266f0decd0.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 28;
                var nbb_unformatted_code = "n = 1000\nmus = [0, 1, 5]\nsigmas = [1, 1, 2]\n\nfor mu, sigma in zip(mus, sigmas):\n    sample = np.random.normal(mu, sigma, n)\n    xs, ys = normal_probability(sample)\n    label = \"$\\\\mu=%d$, $\\\\sigma=%d$\" % (mu, sigma)\n    plt.plot(xs, ys, label=label)\n\ndecorate(\n    title=\"Normal probability plot\",\n    xlabel=\"standard normal sample\",\n    ylabel=\"sample values\",\n)";
                var nbb_formatted_code = "n = 1000\nmus = [0, 1, 5]\nsigmas = [1, 1, 2]\n\nfor mu, sigma in zip(mus, sigmas):\n    sample = np.random.normal(mu, sigma, n)\n    xs, ys = normal_probability(sample)\n    label = \"$\\\\mu=%d$, $\\\\sigma=%d$\" % (mu, sigma)\n    plt.plot(xs, ys, label=label)\n\ndecorate(\n    title=\"Normal probability plot\",\n    xlabel=\"standard normal sample\",\n    ylabel=\"sample values\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Now let’s try it with real data. Here’s code to generate a normal
probability plot for the birth weight data from the previous section. It
plots a gray line that represents the model and a blue line that
represents the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_normal_plot</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">fxs</span><span class="p">,</span> <span class="n">fys</span> <span class="o">=</span> <span class="n">fit_line</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">inter</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="n">std</span><span class="p">)</span>
    <span class="n">thinkplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fxs</span><span class="p">,</span> <span class="n">fys</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>

    <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">normal_probability</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;birth weights&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 30;
                var nbb_unformatted_code = "def make_normal_plot(weights):\n    mean = weights.mean()\n    std = weights.std()\n    xs = [-4, 4]\n    fxs, fys = fit_line(xs, inter=mean, slope=std)\n    thinkplot.plot(fxs, fys, color=\"gray\", name=\"model\")\n\n    xs, ys = normal_probability(weights)\n    plt.plot(xs, ys, label=\"birth weights\")";
                var nbb_formatted_code = "def make_normal_plot(weights):\n    mean = weights.mean()\n    std = weights.std()\n    xs = [-4, 4]\n    fxs, fys = fit_line(xs, inter=mean, slope=std)\n    thinkplot.plot(fxs, fys, color=\"gray\", name=\"model\")\n\n    xs, ys = normal_probability(weights)\n    plt.plot(xs, ys, label=\"birth weights\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">weights</span></code> is a pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> of birth weights; <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span></code> are the
mean and standard deviation.</p>
<p><code class="docutils literal notranslate"><span class="pre">fit_line</span></code> takes a sequence of <code class="docutils literal notranslate"><span class="pre">xs</span></code>, an intercept, and a slope; it
returns <code class="docutils literal notranslate"><span class="pre">xs</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> that represent a line with the given parameters,
evaluated at the values in <code class="docutils literal notranslate"><span class="pre">xs</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">fit_line</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 31;
                var nbb_unformatted_code = "from thinkstats import fit_line";
                var nbb_formatted_code = "from thinkstats import fit_line";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">normal_probability</span></code> returns <code class="docutils literal notranslate"><span class="pre">xs</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> that contain values from the
standard normal distribution and values from <code class="docutils literal notranslate"><span class="pre">weights</span></code>. If the
distribution of weights is normal, the data should match the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">trimmed_mean_var</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 32;
                var nbb_unformatted_code = "mean, var = trimmed_mean_var(weights, p=0.01)\nstd = np.sqrt(var)";
                var nbb_formatted_code = "mean, var = trimmed_mean_var(weights, p=0.01)\nstd = np.sqrt(var)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">fxs</span><span class="p">,</span> <span class="n">fys</span> <span class="o">=</span> <span class="n">fit_line</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fxs</span><span class="p">,</span> <span class="n">fys</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">)</span>

<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">normal_probability</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;all live&quot;</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Normal probability plot&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Standard deviations from mean&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Birth weight (lbs)&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/14c67a5cad173e5287649c8f85fc837bb44c730c6b28158fb85c0d688751f05d.png" src="_images/14c67a5cad173e5287649c8f85fc837bb44c730c6b28158fb85c0d688751f05d.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 34;
                var nbb_unformatted_code = "xs = [-4, 4]\nfxs, fys = fit_line(xs, mean, std)\nplt.plot(fxs, fys, linewidth=4, color=\"0.8\")\n\nxs, ys = normal_probability(weights)\nplt.plot(xs, ys, label=\"all live\")\ndecorate(\n    title=\"Normal probability plot\",\n    xlabel=\"Standard deviations from mean\",\n    ylabel=\"Birth weight (lbs)\",\n)";
                var nbb_formatted_code = "xs = [-4, 4]\nfxs, fys = fit_line(xs, mean, std)\nplt.plot(fxs, fys, linewidth=4, color=\"0.8\")\n\nxs, ys = normal_probability(weights)\nplt.plot(xs, ys, label=\"all live\")\ndecorate(\n    title=\"Normal probability plot\",\n    xlabel=\"Standard deviations from mean\",\n    ylabel=\"Birth weight (lbs)\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>The following figure shows the results for all live
births, and also for full term births (pregnancy length greater than 36
weeks). Both curves match the model near the mean and deviate in the
tails. The heaviest babies are heavier than what the model expects, and
the lightest babies are lighter.</p>
<p>When we select only full term births, we remove some of the lightest
weights, which reduces the discrepancy in the lower tail of the
distribution.</p>
<p>This plot suggests that the normal model describes the distribution well
within a few standard deviations from the mean, but not in the tails.
Whether it is good enough for practical purposes depends on the
purposes.</p>
</section>
<section id="the-lognormal-distribution">
<h2>The lognormal distribution<a class="headerlink" href="#the-lognormal-distribution" title="Link to this heading">#</a></h2>
<p>If the logarithms of a set of values have a normal distribution, the
values have a <strong>lognormal distribution</strong>. The CDF of the lognormal
distribution is the same as the CDF of the normal distribution, with
<span class="math notranslate nohighlight">\(\log x\)</span> substituted for <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="math notranslate nohighlight">
\[CDF_{lognormal}(x) = CDF_{normal}(\log x)\]</div>
<p>The parameters of the
lognormal distribution are usually denoted <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>. But
remember that these parameters are <em>not</em> the mean and standard
deviation; the mean of a lognormal distribution is
<span class="math notranslate nohighlight">\(\exp(\mu +\sigma^2/2)\)</span> and the standard deviation is ugly (see
<a class="reference external" href="http://wikipedia.org/wiki/Log-normal_distribution">http://wikipedia.org/wiki/Log-normal_distribution</a>).</p>
<p>If a sample is approximately lognormal and you plot its CDF on a log-x
scale, it will have the characteristic shape of a normal distribution.
To test how well the sample fits a lognormal model, you can make a
normal probability plot using the log of the values in the sample.</p>
<p>As an example, let’s look at the distribution of adult weights, which is
approximately lognormal.[^2]</p>
<p>The National Center for Chronic Disease Prevention and Health Promotion
conducts an annual survey as part of the Behavioral Risk Factor
Surveillance System (BRFSS).[^3] In 2008, they interviewed 414,509
respondents and asked about their demographics, health, and health
risks. Among the data they collected are the weights in kilograms of
398,484 respondents.</p>
<p>The repository for this book contains <code class="docutils literal notranslate"><span class="pre">CDBRFS08.ASC.gz</span></code>, a fixed-width
ASCII file that contains data from the BRFSS, and <code class="docutils literal notranslate"><span class="pre">brfss.py</span></code>, which
reads the file and analyzes the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/nb/brfss.py&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/data/CDBRFS08.ASC.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 35;
                var nbb_unformatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/brfss.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/CDBRFS08.ASC.gz\")";
                var nbb_formatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/brfss.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/CDBRFS08.ASC.gz\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">brfss</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">brfss</span><span class="o">.</span><span class="n">read_brfss</span><span class="p">()</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">wtkg2</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 36;
                var nbb_unformatted_code = "import brfss\n\ndf = brfss.read_brfss()\nweights = df.wtkg2.dropna()";
                var nbb_formatted_code = "import brfss\n\ndf = brfss.read_brfss()\nweights = df.wtkg2.dropna()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_normal_model</span><span class="p">(</span><span class="n">weights</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots a CDF with a Normal model.</span>

<span class="sd">    weights: sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;weights&quot;</span><span class="p">)</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">trimmed_mean_var</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n, mean, std&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="n">xmin</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">std</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">std</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">render_normal_cdf</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">)</span>
    <span class="n">cdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 39;
                var nbb_unformatted_code = "def make_normal_model(weights):\n    \"\"\"Plots a CDF with a Normal model.\n\n    weights: sequence\n    \"\"\"\n    cdf = Cdf.from_seq(weights, name=\"weights\")\n    mean, var = trimmed_mean_var(weights)\n    std = np.sqrt(var)\n    print(\"n, mean, std\", len(weights), mean, std)\n\n    xmin = mean - 4 * std\n    xmax = mean + 4 * std\n    xs, ps = render_normal_cdf(mean, std, xmin, xmax)\n    plt.plot(xs, ps, label=\"model\", linewidth=4, color=\"0.8\")\n    cdf.plot()";
                var nbb_formatted_code = "def make_normal_model(weights):\n    \"\"\"Plots a CDF with a Normal model.\n\n    weights: sequence\n    \"\"\"\n    cdf = Cdf.from_seq(weights, name=\"weights\")\n    mean, var = trimmed_mean_var(weights)\n    std = np.sqrt(var)\n    print(\"n, mean, std\", len(weights), mean, std)\n\n    xmin = mean - 4 * std\n    xmax = mean + 4 * std\n    xs, ps = render_normal_cdf(mean, std, xmin, xmax)\n    plt.plot(xs, ps, label=\"model\", linewidth=4, color=\"0.8\")\n    cdf.plot()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_normal_model</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Adult weight, linear scale&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Weight (kg)&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n, mean, std 398484 78.59599565702814 17.754555191798282
</pre></div>
</div>
<img alt="_images/fb999d3d0159fe2cbb82092568706a79c758f03ef652bdf672febe1f13be8a57.png" src="_images/fb999d3d0159fe2cbb82092568706a79c758f03ef652bdf672febe1f13be8a57.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 40;
                var nbb_unformatted_code = "make_normal_model(weights)\n\ndecorate(\n    title=\"Adult weight, linear scale\",\n    xlabel=\"Weight (kg)\",\n    ylabel=\"CDF\",\n    loc=\"upper right\",\n)";
                var nbb_formatted_code = "make_normal_model(weights)\n\ndecorate(\n    title=\"Adult weight, linear scale\",\n    xlabel=\"Weight (kg)\",\n    ylabel=\"CDF\",\n    loc=\"upper right\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">make_normal_model</span><span class="p">(</span><span class="n">log_weights</span><span class="p">)</span>
<span class="n">decorate</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Adult weight, log scale&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Weight (log10 kg)&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n, mean, std 398484 1.884660713731975 0.09623580259151703
</pre></div>
</div>
<img alt="_images/7c31ecdd5bdf8e5d6f31268b4370601d18d6270738851633d36c875f78fa0725.png" src="_images/7c31ecdd5bdf8e5d6f31268b4370601d18d6270738851633d36c875f78fa0725.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 41;
                var nbb_unformatted_code = "log_weights = np.log10(weights)\nmake_normal_model(log_weights)\ndecorate(\n    title=\"Adult weight, log scale\",\n    xlabel=\"Weight (log10 kg)\",\n    ylabel=\"CDF\",\n    loc=\"upper right\",\n)";
                var nbb_formatted_code = "log_weights = np.log10(weights)\nmake_normal_model(log_weights)\ndecorate(\n    title=\"Adult weight, log scale\",\n    xlabel=\"Weight (log10 kg)\",\n    ylabel=\"CDF\",\n    loc=\"upper right\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>The following figure (left) shows the distribution of adult weights
on a linear scale with a normal model.
The following figure (right) shows the same distribution on a log
scale with a lognormal model. The lognormal model is a better fit, but
this representation of the data does not make the difference
particularly dramatic.</p>
<p>The following figure shows normal probability plots for
adult weights, <span class="math notranslate nohighlight">\(w\)</span>, and for their logarithms, <span class="math notranslate nohighlight">\(\log_{10} w\)</span>. Now it is
apparent that the data deviate substantially from the normal model. On
the other hand, the lognormal model is a good match for the data.</p>
</section>
<section id="the-pareto-distribution">
<h2>The Pareto distribution<a class="headerlink" href="#the-pareto-distribution" title="Link to this heading">#</a></h2>
<p>The <strong>Pareto distribution</strong> is named after the economist Vilfredo
Pareto, who used it to describe the distribution of wealth (see
<a class="reference external" href="http://wikipedia.org/wiki/Pareto_distribution">http://wikipedia.org/wiki/Pareto_distribution</a>). Since then, it has
been used to describe phenomena in the natural and social sciences
including sizes of cities and towns, sand particles and meteorites,
forest fires and earthquakes.</p>
<p>The CDF of the Pareto distribution is:</p>
<div class="math notranslate nohighlight">
\[CDF(x) = 1 - \left( \frac{x}{x_m} \right) ^{-\alpha}\]</div>
<p>The parameters
<span class="math notranslate nohighlight">\(x_{m}\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> determine the location and shape of the
distribution. <span class="math notranslate nohighlight">\(x_{m}\)</span> is the minimum possible value.
The following figure shows CDFs of Pareto distributions with
<span class="math notranslate nohighlight">\(x_{m} = 0.5\)</span> and different values of <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats</span> <span class="kn">import</span> <span class="n">render_pareto_cdf</span>

<span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]:</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">render_pareto_cdf</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">alpha=</span><span class="si">%g</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="n">alpha</span><span class="p">)</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Pareto CDF&quot;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3c7a738924cd5c546874dc567ad3efaf4178d1b06b6f6dc4b94bf3e29f88bf39.png" src="_images/3c7a738924cd5c546874dc567ad3efaf4178d1b06b6f6dc4b94bf3e29f88bf39.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 43;
                var nbb_unformatted_code = "from thinkstats import render_pareto_cdf\n\nxmin = 0.5\nfor alpha in [2.0, 1.0, 0.5]:\n    xs, ps = render_pareto_cdf(xmin, alpha, 0, 10.0, n=100)\n    plt.plot(xs, ps, label=\"$\\\\alpha=%g$\" % alpha)\n\ndecorate(title=\"Pareto CDF\", xlabel=\"x\", ylabel=\"CDF\", loc=\"lower right\")";
                var nbb_formatted_code = "from thinkstats import render_pareto_cdf\n\nxmin = 0.5\nfor alpha in [2.0, 1.0, 0.5]:\n    xs, ps = render_pareto_cdf(xmin, alpha, 0, 10.0, n=100)\n    plt.plot(xs, ps, label=\"$\\\\alpha=%g$\" % alpha)\n\ndecorate(title=\"Pareto CDF\", xlabel=\"x\", ylabel=\"CDF\", loc=\"lower right\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>There is a simple visual test that indicates whether an empirical
distribution fits a Pareto distribution: on a log-log scale, the CCDF
looks like a straight line. Let’s see why that works.</p>
<p>If you plot the CCDF of a sample from a Pareto distribution on a linear
scale, you expect to see a function like:
$<span class="math notranslate nohighlight">\(y \approx \left( \frac{x}{x_m} \right) ^{-\alpha}\)</span><span class="math notranslate nohighlight">\( Taking the log of
both sides yields: \)</span><span class="math notranslate nohighlight">\(\log y \approx -\alpha (\log x - \log x_{m})\)</span><span class="math notranslate nohighlight">\( So
if you plot \)</span>\log y<span class="math notranslate nohighlight">\( versus \)</span>\log x<span class="math notranslate nohighlight">\(, it should look like a straight
line with slope \)</span>-\alpha<span class="math notranslate nohighlight">\( and intercept \)</span>\alpha \log x_{m}$.</p>
<p>As an example, let’s look at the sizes of cities and towns. The
U.S. Census Bureau publishes the population of every incorporated city
and town in the United States.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/nb/populations.py&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/data/PEP_2012_PEPANNRES_with_ann.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 44;
                var nbb_unformatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/populations.py\")\ndownload(\n    \"https://github.com/AllenDowney/ThinkStats/raw/v3/data/PEP_2012_PEPANNRES_with_ann.csv\"\n)";
                var nbb_formatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/populations.py\")\ndownload(\n    \"https://github.com/AllenDowney/ThinkStats/raw/v3/data/PEP_2012_PEPANNRES_with_ann.csv\"\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">populations</span>

<span class="n">pops</span> <span class="o">=</span> <span class="n">populations</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of cities/towns&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pops</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of cities/towns 19515
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 45;
                var nbb_unformatted_code = "import populations\n\npops = populations.read_data()\nprint(\"Number of cities/towns\", len(pops))";
                var nbb_formatted_code = "import populations\n\npops = populations.read_data()\nprint(\"Number of cities/towns\", len(pops))";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>I downloaded their data from
<a class="reference external" href="http://www.census.gov/popest/data/cities/totals/2012/SUB-EST2012-3.html">http://www.census.gov/popest/data/cities/totals/2012/SUB-EST2012-3.html</a>;
it is in the repository for this book in a file named
<code class="docutils literal notranslate"><span class="pre">PEP_2012_PEPANNRES_with_ann.csv</span></code>. The repository also contains
<code class="docutils literal notranslate"><span class="pre">populations.py</span></code>, which reads the file and plots the distribution of
populations.</p>
<p>The following figure shows the CCDF of populations on a
log-log scale. The largest 1% of cities and towns, below <span class="math notranslate nohighlight">\(10^{-2}\)</span>, fall
along a straight line. So we could conclude, as some researchers have,
that the tail of this distribution fits a Pareto model.</p>
<p>On the other hand, a lognormal distribution also models the data well.
The following figure shows the CDF of populations and a
lognormal model (left), and a normal probability plot (right). Both
plots show good agreement between the data and the model.</p>
<p>Neither model is perfect. The Pareto model only applies to the largest
1% of cities, but it is a better fit for that part of the distribution.
The lognormal model is a better fit for the other 99%. Which model is
appropriate depends on which part of the distribution is relevant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_pops</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">pops</span><span class="p">)</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">cdf_log</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">log_pops</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 46;
                var nbb_unformatted_code = "log_pops = np.log10(pops)\ncdf = Cdf.from_seq(pops, name=\"data\")\ncdf_log = Cdf.from_seq(log_pops, name=\"data\")";
                var nbb_formatted_code = "log_pops = np.log10(pops)\ncdf = Cdf.from_seq(pops, name=\"data\")\ncdf_log = Cdf.from_seq(log_pops, name=\"data\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">render_pareto_cdf</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">10000000.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_log</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log10 population&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/703abb693777ee5f433d2f92aaf59659a011e5eb76a76e9d91cdd2f0ff641612.png" src="_images/703abb693777ee5f433d2f92aaf59659a011e5eb76a76e9d91cdd2f0ff641612.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 47;
                var nbb_unformatted_code = "xs, ys = render_pareto_cdf(xmin=5000, alpha=1.4, low=0, high=10000000.0)\nplt.plot(np.log10(xs), 1 - ys, label=\"model\", color=\"0.8\")\n\n(1-cdf_log).plot()\n\ndecorate(\n    xlabel=\"log10 population\", ylabel=\"CCDF\", yscale=\"log\", loc=\"lower left\"\n)";
                var nbb_formatted_code = "xs, ys = render_pareto_cdf(xmin=5000, alpha=1.4, low=0, high=10000000.0)\nplt.plot(np.log10(xs), 1 - ys, label=\"model\", color=\"0.8\")\n\n(1 - cdf_log).plot()\n\ndecorate(xlabel=\"log10 population\", ylabel=\"CCDF\", yscale=\"log\", loc=\"lower left\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="n">log_pops</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">log_pops</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">render_normal_cdf</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">)</span>
<span class="n">cdf_log</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log10 population&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2e42ec3a78dfb8caa2a1ff714a45b61260ef8a1a27aa9ab957a595759eea6857.png" src="_images/2e42ec3a78dfb8caa2a1ff714a45b61260ef8a1a27aa9ab957a595759eea6857.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 49;
                var nbb_unformatted_code = "mu, sigma = log_pops.mean(), log_pops.std()\nxs, ps = render_normal_cdf(mu, sigma, low=0, high=8)\nplt.plot(xs, ps, label=\"model\", color=\"0.8\")\ncdf_log.plot()\ndecorate(xlabel=\"log10 population\", ylabel=\"CDF\", loc=\"lower right\")";
                var nbb_formatted_code = "mu, sigma = log_pops.mean(), log_pops.std()\nxs, ps = render_normal_cdf(mu, sigma, low=0, high=8)\nplt.plot(xs, ps, label=\"model\", color=\"0.8\")\ncdf_log.plot()\ndecorate(xlabel=\"log10 population\", ylabel=\"CDF\", loc=\"lower right\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</section>
<section id="generating-random-numbers">
<h2>Generating random numbers<a class="headerlink" href="#generating-random-numbers" title="Link to this heading">#</a></h2>
<p>Analytic CDFs can be used to generate random numbers with a given
distribution function, <span class="math notranslate nohighlight">\(p = CDF(x)\)</span>. If there is an efficient way to
compute the inverse CDF, we can generate random values with the
appropriate distribution by choosing <span class="math notranslate nohighlight">\(p\)</span> from a uniform distribution
between 0 and 1, then choosing <span class="math notranslate nohighlight">\(x = ICDF(p)\)</span>.</p>
<p>For example, the CDF of the exponential distribution is
$<span class="math notranslate nohighlight">\(p = 1 - e^{-\lambda x}\)</span><span class="math notranslate nohighlight">\( Solving for \)</span>x<span class="math notranslate nohighlight">\( yields:
\)</span><span class="math notranslate nohighlight">\(x = -\log (1 - p) / \lambda\)</span>$ So in Python we can write</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>


<span class="k">def</span> <span class="nf">expovariate</span><span class="p">(</span><span class="n">lam</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">/</span> <span class="n">lam</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 50;
                var nbb_unformatted_code = "import random\n\n\ndef expovariate(lam):\n    p = random.random()\n    x = -np.log(1 - p) / lam\n    return x";
                var nbb_formatted_code = "import random\n\n\ndef expovariate(lam):\n    p = random.random()\n    x = -np.log(1 - p) / lam\n    return x";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">expovariate</span></code> takes <code class="docutils literal notranslate"><span class="pre">lam</span></code> and returns a random value chosen from the
exponential distribution with parameter <code class="docutils literal notranslate"><span class="pre">lam</span></code>.</p>
<p>Two notes about this implementation: I called the parameter <code class="docutils literal notranslate"><span class="pre">lam</span></code>
because <code class="docutils literal notranslate"><span class="pre">lambda</span></code> is a Python keyword. Also, since <span class="math notranslate nohighlight">\(\log 0\)</span> is undefined,
we have to be a little careful. The implementation of <code class="docutils literal notranslate"><span class="pre">random.random</span></code>
can return 0 but not 1, so <span class="math notranslate nohighlight">\(1 - p\)</span> can be 1 but not 0, so <code class="docutils literal notranslate"><span class="pre">log(1-p)</span></code> is
always defined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">expovariate</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 51;
                var nbb_unformatted_code = "t = [expovariate(lam=2) for _ in range(1000)]";
                var nbb_formatted_code = "t = [expovariate(lam=2) for _ in range(1000)]";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Exponential variate&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a1d6c2c6104e8fce10fa00b9536e7539bb002d6eca6b0da4b76babd5e5a12ee.png" src="_images/1a1d6c2c6104e8fce10fa00b9536e7539bb002d6eca6b0da4b76babd5e5a12ee.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 53;
                var nbb_unformatted_code = "cdf = Cdf.from_seq(t)\n(1-cdf).plot()\ndecorate(xlabel=\"Exponential variate\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_formatted_code = "cdf = Cdf.from_seq(t)\n(1 - cdf).plot()\ndecorate(xlabel=\"Exponential variate\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</section>
<section id="why-model">
<h2>Why model?<a class="headerlink" href="#why-model" title="Link to this heading">#</a></h2>
<p>At the beginning of this chapter, I said that many real world phenomena
can be modeled with analytic distributions. “So,” you might ask, “what?”</p>
<p>Like all models, analytic distributions are abstractions, which means
they leave out details that are considered irrelevant. For example, an
observed distribution might have measurement errors or quirks that are
specific to the sample; analytic models smooth out these idiosyncrasies.</p>
<p>Analytic models are also a form of data compression. When a model fits a
dataset well, a small set of parameters can summarize a large amount of
data.</p>
<p>It is sometimes surprising when data from a natural phenomenon fit an
analytic distribution, but these observations can provide insight into
physical systems. Sometimes we can explain why an observed distribution
has a particular form. For example, Pareto distributions are often the
result of generative processes with positive feedback (so-called
preferential attachment processes: see
<a class="reference external" href="http://wikipedia.org/wiki/Preferential_attachment">http://wikipedia.org/wiki/Preferential_attachment</a>.).</p>
<p>Also, analytic distributions lend themselves to mathematical analysis,
as we will see in Chapter <a class="reference internal" href="#analysis"><span class="xref myst">[analysis]</span></a>{reference-type=“ref”
reference=“analysis”}.</p>
<p>But it is important to remember that all models are imperfect. Data from
the real world never fit an analytic distribution perfectly. People
sometimes talk as if data are generated by models; for example, they
might say that the distribution of human heights is normal, or the
distribution of income is lognormal. Taken literally, these claims
cannot be true; there are always differences between the real world and
mathematical models.</p>
<p>Models are useful if they capture the relevant aspects of the real world
and leave out unneeded details. But what is “relevant” or “unneeded”
depends on what you are planning to use the model for.</p>
<p>A straight line is consistent with an exponential distribution.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise">
<h3>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h3>
<p>Write a function that generates a Pareto variate. Generate a sample and plot its complementary CDF on a log-log scale. Does it look like a straight line?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sample_pareto</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">x_m</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_m</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 54;
                var nbb_unformatted_code = "def sample_pareto(alpha, x_m, size):\n    u = np.random.random(size)\n    return x_m * pow(1 - u, -1 / alpha)";
                var nbb_formatted_code = "def sample_pareto(alpha, x_m, size):\n    u = np.random.random(size)\n    return x_m * pow(1 - u, -1 / alpha)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">sample_pareto</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Random values&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b167fbe7ac349e6b7cda30b25670a7980eb532a8b48209b6e730a3bc4e5fa8b5.png" src="_images/b167fbe7ac349e6b7cda30b25670a7980eb532a8b48209b6e730a3bc4e5fa8b5.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 55;
                var nbb_unformatted_code = "sample = sample_pareto(1, 2, 1000)\ncdf = Cdf.from_seq(sample)\n(1-cdf).plot()\ndecorate(xlabel=\"Random values\", ylabel=\"CCDF\", xscale=\"log\", yscale=\"log\")";
                var nbb_formatted_code = "sample = sample_pareto(1, 2, 1000)\ncdf = Cdf.from_seq(sample)\n(1 - cdf).plot()\ndecorate(xlabel=\"Random values\", ylabel=\"CCDF\", xscale=\"log\", yscale=\"log\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</section>
<section id="id1">
<h3>Exercise<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>In the BRFSS (see Section 5.4), the distribution of heights is roughly normal with parameters µ = 178 cm and σ = 7.7 cm for men, and µ = 163 cm and σ = 7.3 cm for women.</p>
<p>In order to join Blue Man Group, you have to be male between 5’10” and 6’1” (see <a class="reference external" href="http://bluemancasting.com">http://bluemancasting.com</a>). What percentage of the U.S. male population is in this range? Hint: use <code class="docutils literal notranslate"><span class="pre">scipy.stats.norm.cdf</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> contains objects that represent analytic distributions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 56;
                var nbb_unformatted_code = "import scipy.stats";
                var nbb_formatted_code = "import scipy.stats";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>For example <tt>scipy.stats.norm</tt> represents a normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">178</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">7.7</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>scipy.stats._distn_infrastructure.rv_continuous_frozen
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 57;
                var nbb_unformatted_code = "mu = 178\nsigma = 7.7\ndist = scipy.stats.norm(loc=mu, scale=sigma)\ntype(dist)";
                var nbb_formatted_code = "mu = 178\nsigma = 7.7\ndist = scipy.stats.norm(loc=mu, scale=sigma)\ntype(dist)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>A “frozen random variable” can compute its mean and standard deviation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">dist</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(178.0, 7.7)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 58;
                var nbb_unformatted_code = "dist.mean(), dist.std()";
                var nbb_formatted_code = "dist.mean(), dist.std()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>It can also evaluate its CDF.  How many people are below the mean by more than one standard deviation?  About 16%</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1586552539314574
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 59;
                var nbb_unformatted_code = "dist.cdf(mu - sigma)";
                var nbb_formatted_code = "dist.cdf(mu - sigma)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>How many people are between 5’10” and 6’1”?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">low</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">177.8</span><span class="p">)</span>
<span class="n">high</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">185.4</span><span class="p">)</span>
<span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">,</span> <span class="n">high</span> <span class="o">-</span> <span class="n">low</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.48963902786483265, 0.8317337108107857, 0.3420946829459531)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 60;
                var nbb_unformatted_code = "low = dist.cdf(177.8)\nhigh = dist.cdf(185.4)\nlow, high, high - low";
                var nbb_formatted_code = "low = dist.cdf(177.8)\nhigh = dist.cdf(185.4)\nlow, high, high - low";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</section>
<section id="id2">
<h3>Exercise<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>To get a feel for the Pareto distribution, let’s see how different the world would be if the distribution of human height were Pareto. With the parameters xm = 1 m and α = 1.7, we get a distribution with a reasonable minimum, 1 m, and median, 1.5 m.</p>
<p>Plot this distribution. What is the mean human height in Pareto world? What fraction of the population is shorter than the mean? If there are 7 billion people in Pareto world, how many do we expect to be taller than 1 km? How tall do we expect the tallest person to be?</p>
<p><code class="docutils literal notranslate"><span class="pre">scipy.stats.pareto</span></code> represents a Pareto distribution.  In Pareto world, the distribution of human heights has parameters alpha=1.7 and xmin=1 meter.  So the shortest person is 100 cm and the median is 150.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.7</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">pareto</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">xmin</span><span class="p">)</span>
<span class="n">dist</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5034066538560549
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 61;
                var nbb_unformatted_code = "alpha = 1.7\nxmin = 1\ndist = scipy.stats.pareto(b=alpha, scale=xmin)\ndist.median()";
                var nbb_formatted_code = "alpha = 1.7\nxmin = 1\ndist = scipy.stats.pareto(b=alpha, scale=xmin)\ndist.median()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>What is the mean height in Pareto world?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.428571428571429
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 62;
                var nbb_unformatted_code = "dist.mean()";
                var nbb_formatted_code = "dist.mean()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>What fraction of people are shorter than the mean?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.778739697565288
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 63;
                var nbb_unformatted_code = "dist.cdf(dist.mean())";
                var nbb_formatted_code = "dist.cdf(dist.mean())";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Out of 7 billion people, how many do we expect to be taller than 1 km?  You could use <tt>dist.cdf</tt> or <tt>dist.sf</tt>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span> <span class="o">*</span> <span class="mf">7000000000.0</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="mf">7000000000.0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(55602.976430479954, 55602.97643069972)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 64;
                var nbb_unformatted_code = "(1 - dist.cdf(1000)) * 7000000000.0, dist.sf(1000) * 7000000000.0";
                var nbb_formatted_code = "(1 - dist.cdf(1000)) * 7000000000.0, dist.sf(1000) * 7000000000.0";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>How tall do we expect the tallest person to be?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mi">600000</span><span class="p">)</span> <span class="o">*</span> <span class="mf">7000000000.0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0525455861201714
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 65;
                var nbb_unformatted_code = "dist.sf(600000) * 7000000000.0";
                var nbb_formatted_code = "dist.sf(600000) * 7000000000.0";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">7000000000.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>618349.6106759505
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 66;
                var nbb_unformatted_code = "dist.ppf(1 - 1 / 7000000000.0)";
                var nbb_formatted_code = "dist.ppf(1 - 1 / 7000000000.0)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</section>
<section id="id3">
<h3>Exercise<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>The Weibull distribution is a generalization of the exponential distribution that comes up in failure analysis (see <a class="reference external" href="http://wikipedia.org/wiki/Weibull_distribution">http://wikipedia.org/wiki/Weibull_distribution</a>). Its CDF is</p>
<p><span class="math notranslate nohighlight">\(\mathrm{CDF}(x) = 1 − \exp[−(x / λ)^k]\)</span></p>
<p>Can you find a transformation that makes a Weibull distribution look like a straight line? What do the slope and intercept of the line indicate?</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">random.weibullvariate</span></code> to generate a sample from a Weibull distribution and use it to test your transformation.</p>
<p>Generate a sample from a Weibull distribution and plot it using a transform that makes a Weibull distribution look like a straight line.</p>
<p>If you are stuck, you can get a hint from <code class="docutils literal notranslate"><span class="pre">thinkplot.Cdf</span></code>, which provides a transform that makes the CDF of a Weibull distribution look like a straight line.  Here’s an example that shows how it’s used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: implement the Weibull transform</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 68;
                var nbb_unformatted_code = "# TODO: implement the Weibull transform";
                var nbb_formatted_code = "# TODO: implement the Weibull transform";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">weibullvariate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">cdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Weibull variate&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a19ff395987ca0e8e1bded2e88b2cab156474b04b098174ee9bca04854191d53.png" src="_images/a19ff395987ca0e8e1bded2e88b2cab156474b04b098174ee9bca04854191d53.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 69;
                var nbb_unformatted_code = "sample = [random.weibullvariate(2, 1) for _ in range(1000)]\ncdf = Cdf.from_seq(sample)\ncdf.plot()\ndecorate(xlabel=\"Weibull variate\", ylabel=\"CCDF\", xscale=\"log\", yscale=\"log\")";
                var nbb_formatted_code = "sample = [random.weibullvariate(2, 1) for _ in range(1000)]\ncdf = Cdf.from_seq(sample)\ncdf.plot()\ndecorate(xlabel=\"Weibull variate\", ylabel=\"CCDF\", xscale=\"log\", yscale=\"log\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
</section>
<section id="id4">
<h3>Exercise<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>For small values of <code class="docutils literal notranslate"><span class="pre">n</span></code>, we don’t expect an empirical distribution to fit an analytic distribution exactly. One way to evaluate the quality of fit is to generate a sample from an analytic distribution and see how well it matches the data.</p>
<p>For example, in Section 5.1 we plotted the distribution of time between births and saw that it is approximately exponential. But the distribution is based on only 44 data points. To see whether the data might have come from an exponential distribution, generate 44 values from an exponential distribution with the same mean as the data, about 33 minutes between births.</p>
<p>Plot the distribution of the random values and compare it to the actual distribution. You can use random.expovariate to generate the values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">read_baby_boom</span><span class="p">()</span>
<span class="n">diffs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">minutes</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">cdf_diffs</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;actual&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 74;
                var nbb_unformatted_code = "df = read_baby_boom()\ndiffs = df.minutes.diff()\ncdf_diffs = Cdf.from_seq(diffs, name=\"actual\")";
                var nbb_formatted_code = "df = read_baby_boom()\ndiffs = df.minutes.diff()\ncdf_diffs = Cdf.from_seq(diffs, name=\"actual\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mf">44.0</span> <span class="o">/</span> <span class="mi">24</span> <span class="o">/</span> <span class="mi">60</span>
<span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="mi">1</span> <span class="o">/</span> <span class="n">lam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(32.72727272727273, 25.613889732228078)
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 75;
                var nbb_unformatted_code = "n = len(diffs)\nlam = 44.0 / 24 / 60\nsample = [random.expovariate(lam) for _ in range(n)]\n1 / lam, np.mean(sample)";
                var nbb_formatted_code = "n = len(diffs)\nlam = 44.0 / 24 / 60\nsample = [random.expovariate(lam) for _ in range(n)]\n1 / lam, np.mean(sample)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 76;
                var nbb_unformatted_code = "model = Cdf.from_seq(sample, name=\"model\")";
                var nbb_formatted_code = "model = Cdf.from_seq(sample, name=\"model\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_diffs</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time between births (minutes)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8ffa094218a51db0e18196ecd699a7898390940d20ba30775de016e2be794f5b.png" src="_images/8ffa094218a51db0e18196ecd699a7898390940d20ba30775de016e2be794f5b.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 77;
                var nbb_unformatted_code = "(1 - model).plot()\n(1 - cdf_diffs).plot()\ndecorate(xlabel=\"Time between births (minutes)\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_formatted_code = "(1 - model).plot()\n(1 - cdf_diffs).plot()\ndecorate(xlabel=\"Time between births (minutes)\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="o">.</span><span class="n">from_seq</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.9&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf_diffs</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Time between births (minutes)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a8963764a3d32fa47978c9062e750b8a20f34632ef143054a17bdd9bb87504c9.png" src="_images/a8963764a3d32fa47978c9062e750b8a20f34632ef143054a17bdd9bb87504c9.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 80;
                var nbb_unformatted_code = "for i in range(100):\n    sample = [random.expovariate(lam) for _ in range(n)]\n    cdf = Cdf.from_seq(sample, name=\"\")\n    (1 - cdf).plot(color=\"0.9\")\n(1 - cdf_diffs).plot()\ndecorate(xlabel=\"Time between births (minutes)\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_formatted_code = "for i in range(100):\n    sample = [random.expovariate(lam) for _ in range(n)]\n    cdf = Cdf.from_seq(sample, name=\"\")\n    (1 - cdf).plot(color=\"0.9\")\n(1 - cdf_diffs).plot()\ndecorate(xlabel=\"Time between births (minutes)\", ylabel=\"CCDF\", yscale=\"log\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p><strong>Bonus Example:</strong> The distributions of wealth and income are sometimes modeled using lognormal and Pareto distributions. To see which is better, let’s look at some data.</p>
<p>The Current Population Survey (CPS) is a joint effort of the Bureau of Labor Statistics and the Census Bureau to study income and related variables. Data collected in 2013 is available from <a class="reference external" href="http://www.census.gov/hhes/www/cpstables/032013/hhinc/toc.htm">http://www.census.gov/hhes/www/cpstables/032013/hhinc/toc.htm</a>. I downloaded <code class="docutils literal notranslate"><span class="pre">hinc06.xls</span></code>, which is an Excel spreadsheet with information about household income, and converted it to <code class="docutils literal notranslate"><span class="pre">hinc06.csv</span></code>, a CSV file you will find in the repository for this book. You will also find <code class="docutils literal notranslate"><span class="pre">hinc.py</span></code>, which reads this file.</p>
<p>Extract the distribution of incomes from this dataset. Are any of the analytic distributions in this chapter a good model of the data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/nb/hinc.py&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats/raw/v3/data/hinc06.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 81;
                var nbb_unformatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/hinc.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/hinc06.csv\")";
                var nbb_formatted_code = "download(\"https://github.com/AllenDowney/ThinkStats/raw/v3/nb/hinc.py\")\ndownload(\"https://github.com/AllenDowney/ThinkStats/raw/v3/data/hinc06.csv\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hinc</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">hinc</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>freq</th>
      <th>cumsum</th>
      <th>ps</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4999.0</td>
      <td>4204</td>
      <td>4204</td>
      <td>0.034330</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9999.0</td>
      <td>4729</td>
      <td>8933</td>
      <td>0.072947</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14999.0</td>
      <td>6982</td>
      <td>15915</td>
      <td>0.129963</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19999.0</td>
      <td>7157</td>
      <td>23072</td>
      <td>0.188407</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24999.0</td>
      <td>7131</td>
      <td>30203</td>
      <td>0.246640</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29999.0</td>
      <td>6740</td>
      <td>36943</td>
      <td>0.301679</td>
    </tr>
    <tr>
      <th>6</th>
      <td>34999.0</td>
      <td>6354</td>
      <td>43297</td>
      <td>0.353566</td>
    </tr>
    <tr>
      <th>7</th>
      <td>39999.0</td>
      <td>5832</td>
      <td>49129</td>
      <td>0.401191</td>
    </tr>
    <tr>
      <th>8</th>
      <td>44999.0</td>
      <td>5547</td>
      <td>54676</td>
      <td>0.446488</td>
    </tr>
    <tr>
      <th>9</th>
      <td>49999.0</td>
      <td>5254</td>
      <td>59930</td>
      <td>0.489392</td>
    </tr>
    <tr>
      <th>10</th>
      <td>54999.0</td>
      <td>5102</td>
      <td>65032</td>
      <td>0.531056</td>
    </tr>
    <tr>
      <th>11</th>
      <td>59999.0</td>
      <td>4256</td>
      <td>69288</td>
      <td>0.565810</td>
    </tr>
    <tr>
      <th>12</th>
      <td>64999.0</td>
      <td>4356</td>
      <td>73644</td>
      <td>0.601382</td>
    </tr>
    <tr>
      <th>13</th>
      <td>69999.0</td>
      <td>3949</td>
      <td>77593</td>
      <td>0.633629</td>
    </tr>
    <tr>
      <th>14</th>
      <td>74999.0</td>
      <td>3756</td>
      <td>81349</td>
      <td>0.664301</td>
    </tr>
    <tr>
      <th>15</th>
      <td>79999.0</td>
      <td>3414</td>
      <td>84763</td>
      <td>0.692180</td>
    </tr>
    <tr>
      <th>16</th>
      <td>84999.0</td>
      <td>3326</td>
      <td>88089</td>
      <td>0.719341</td>
    </tr>
    <tr>
      <th>17</th>
      <td>89999.0</td>
      <td>2643</td>
      <td>90732</td>
      <td>0.740923</td>
    </tr>
    <tr>
      <th>18</th>
      <td>94999.0</td>
      <td>2678</td>
      <td>93410</td>
      <td>0.762792</td>
    </tr>
    <tr>
      <th>19</th>
      <td>99999.0</td>
      <td>2223</td>
      <td>95633</td>
      <td>0.780945</td>
    </tr>
    <tr>
      <th>20</th>
      <td>104999.0</td>
      <td>2606</td>
      <td>98239</td>
      <td>0.802226</td>
    </tr>
    <tr>
      <th>21</th>
      <td>109999.0</td>
      <td>1838</td>
      <td>100077</td>
      <td>0.817235</td>
    </tr>
    <tr>
      <th>22</th>
      <td>114999.0</td>
      <td>1986</td>
      <td>102063</td>
      <td>0.833453</td>
    </tr>
    <tr>
      <th>23</th>
      <td>119999.0</td>
      <td>1464</td>
      <td>103527</td>
      <td>0.845408</td>
    </tr>
    <tr>
      <th>24</th>
      <td>124999.0</td>
      <td>1596</td>
      <td>105123</td>
      <td>0.858441</td>
    </tr>
    <tr>
      <th>25</th>
      <td>129999.0</td>
      <td>1327</td>
      <td>106450</td>
      <td>0.869278</td>
    </tr>
    <tr>
      <th>26</th>
      <td>134999.0</td>
      <td>1253</td>
      <td>107703</td>
      <td>0.879510</td>
    </tr>
    <tr>
      <th>27</th>
      <td>139999.0</td>
      <td>1140</td>
      <td>108843</td>
      <td>0.888819</td>
    </tr>
    <tr>
      <th>28</th>
      <td>144999.0</td>
      <td>1119</td>
      <td>109962</td>
      <td>0.897957</td>
    </tr>
    <tr>
      <th>29</th>
      <td>149999.0</td>
      <td>920</td>
      <td>110882</td>
      <td>0.905470</td>
    </tr>
    <tr>
      <th>30</th>
      <td>154999.0</td>
      <td>1143</td>
      <td>112025</td>
      <td>0.914803</td>
    </tr>
    <tr>
      <th>31</th>
      <td>159999.0</td>
      <td>805</td>
      <td>112830</td>
      <td>0.921377</td>
    </tr>
    <tr>
      <th>32</th>
      <td>164999.0</td>
      <td>731</td>
      <td>113561</td>
      <td>0.927347</td>
    </tr>
    <tr>
      <th>33</th>
      <td>169999.0</td>
      <td>575</td>
      <td>114136</td>
      <td>0.932042</td>
    </tr>
    <tr>
      <th>34</th>
      <td>174999.0</td>
      <td>616</td>
      <td>114752</td>
      <td>0.937072</td>
    </tr>
    <tr>
      <th>35</th>
      <td>179999.0</td>
      <td>570</td>
      <td>115322</td>
      <td>0.941727</td>
    </tr>
    <tr>
      <th>36</th>
      <td>184999.0</td>
      <td>502</td>
      <td>115824</td>
      <td>0.945826</td>
    </tr>
    <tr>
      <th>37</th>
      <td>189999.0</td>
      <td>364</td>
      <td>116188</td>
      <td>0.948799</td>
    </tr>
    <tr>
      <th>38</th>
      <td>194999.0</td>
      <td>432</td>
      <td>116620</td>
      <td>0.952327</td>
    </tr>
    <tr>
      <th>39</th>
      <td>199999.0</td>
      <td>378</td>
      <td>116998</td>
      <td>0.955413</td>
    </tr>
    <tr>
      <th>40</th>
      <td>249999.0</td>
      <td>2549</td>
      <td>119547</td>
      <td>0.976229</td>
    </tr>
    <tr>
      <th>41</th>
      <td>inf</td>
      <td>2911</td>
      <td>122458</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div><script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 82;
                var nbb_unformatted_code = "import hinc\n\ndf = hinc.read_data()\ndf";
                var nbb_formatted_code = "import hinc\n\ndf = hinc.read_data()\ndf";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Here’s what the CDF looks like on a linear scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">income</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">ps</span><span class="o">.</span><span class="n">values</span>

<span class="n">cdf</span> <span class="o">=</span> <span class="n">Cdf</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">cdf_log</span> <span class="o">=</span> <span class="n">Cdf</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;log data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 99;
                var nbb_unformatted_code = "xs, ps = df.income.values, df.ps.values\n\ncdf = Cdf(ps, xs, name=\"data\")\ncdf_log = Cdf(ps, np.log10(xs), name=\"log data\")";
                var nbb_formatted_code = "xs, ps = df.income.values, df.ps.values\n\ncdf = Cdf(ps, xs, name=\"data\")\ncdf_log = Cdf(ps, np.log10(xs), name=\"log data\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;household income&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a0b35d13c8e221c90854378029e18fae7f01e3963cf5c6c1e81f1699b57b7079.png" src="_images/a0b35d13c8e221c90854378029e18fae7f01e3963cf5c6c1e81f1699b57b7079.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 100;
                var nbb_unformatted_code = "cdf.plot()\ndecorate(xlabel=\"household income\", ylabel=\"CDF\")";
                var nbb_formatted_code = "cdf.plot()\ndecorate(xlabel=\"household income\", ylabel=\"CDF\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>To check whether a Pareto model describes the data well, I plot the CCDF on a log-log scale.</p>
<p>I found parameters for the Pareto model that match the tail of the distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">render_pareto_cdf</span><span class="p">(</span><span class="n">xmin</span><span class="o">=</span><span class="mi">55000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">250000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cdf</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log10 household income&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CCDF&quot;</span><span class="p">,</span>
    <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/17a8aee495865a6cd8ca9ddc3e81a6d0c2f32a40b2b1fcfc621c0aab71902b25.png" src="_images/17a8aee495865a6cd8ca9ddc3e81a6d0c2f32a40b2b1fcfc621c0aab71902b25.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 101;
                var nbb_unformatted_code = "xs, ys = render_pareto_cdf(xmin=55000, alpha=2.5, low=0, high=250000)\nplt.plot(xs, 1 - ys, label=\"model\", color=\"0.8\")\n(1 - cdf).plot()\ndecorate(\n    xlabel=\"log10 household income\",\n    ylabel=\"CCDF\",\n    xscale=\"log\",\n    yscale=\"log\",\n    loc=\"lower left\",\n)";
                var nbb_formatted_code = "xs, ys = render_pareto_cdf(xmin=55000, alpha=2.5, low=0, high=250000)\nplt.plot(xs, 1 - ys, label=\"model\", color=\"0.8\")\n(1 - cdf).plot()\ndecorate(\n    xlabel=\"log10 household income\",\n    ylabel=\"CCDF\",\n    xscale=\"log\",\n    yscale=\"log\",\n    loc=\"lower left\",\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>For the lognormal model I estimate mu and sigma using percentile-based statistics (median and IQR).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">median</span> <span class="o">=</span> <span class="n">cdf_log</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">iqr</span> <span class="o">=</span> <span class="n">cdf_log</span><span class="o">.</span><span class="n">inverse</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">iqr</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.349</span>
<span class="n">std</span> <span class="o">=</span> <span class="mf">0.35</span>
<span class="nb">print</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.740354793159152 0.35
</pre></div>
</div>
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 108;
                var nbb_unformatted_code = "median = cdf_log.inverse(0.5)\niqr = cdf_log.inverse([0.25, 0.75])\nstd = np.diff(iqr) / 1.349\nstd = 0.35\nprint(median, std)";
                var nbb_formatted_code = "median = cdf_log.inverse(0.5)\niqr = cdf_log.inverse([0.25, 0.75])\nstd = np.diff(iqr) / 1.349\nstd = 0.35\nprint(median, std)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>Here’s what the distribution, and fitted model, look like on a log-x scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">render_normal_cdf</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">5.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.8&quot;</span><span class="p">)</span>
<span class="n">cdf_log</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">decorate</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;log10 household income&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;CDF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/da5673c2dcb3c0db072128bdcf11bf9181f3a2a04ac8211902021e22fce0674e.png" src="_images/da5673c2dcb3c0db072128bdcf11bf9181f3a2a04ac8211902021e22fce0674e.png" />
<script type="application/javascript">
            setTimeout(function() {
                var nbb_cell_id = 109;
                var nbb_unformatted_code = "xs, ps = render_normal_cdf(median, std, low=3.5, high=5.5)\nplt.plot(xs, ps, label=\"model\", color=\"0.8\")\ncdf_log.plot()\ndecorate(xlabel=\"log10 household income\", ylabel=\"CDF\")";
                var nbb_formatted_code = "xs, ps = render_normal_cdf(median, std, low=3.5, high=5.5)\nplt.plot(xs, ps, label=\"model\", color=\"0.8\")\ncdf_log.plot()\ndecorate(xlabel=\"log10 household income\", ylabel=\"CDF\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            </script></div>
</div>
<p>My conclusions based on these figures are:</p>
<ol class="arabic simple">
<li><p>The Pareto model might be a reasonable choice for the top
10-20% of incomes.</p></li>
<li><p>The lognormal model captures the shape of the distribution better,
with some deviation in the left tail.  With different
choices for sigma, you could match the upper or lower tail, but not
both at the same time.</p></li>
</ol>
<p>In summary I would say that neither model captures the whole distribution,
so you might have to</p>
<ol class="arabic simple">
<li><p>look for another analytic model,</p></li>
<li><p>choose one that captures the part of the distribution that is most
relevent, or</p></li>
<li><p>avoid using an analytic model altogether.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap04.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Cumulative distribution functions</p>
      </div>
    </a>
    <a class="right-next"
       href="chap06.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Probability density functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-exponential-distribution">The exponential distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-normal-distribution">The normal distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-probability-plot">Normal probability plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lognormal-distribution">The lognormal distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-pareto-distribution">The Pareto distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-random-numbers">Generating random numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-model">Why model?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercise</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Exercise</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>