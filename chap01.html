
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Exploratory data analysis &#8212; Think Stats, 3rd edition</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap01';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Distributions" href="chap02.html" />
    <link rel="prev" title="Preface" href="chap00.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Think Stats, 3rd edition</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Think Stats, 3rd edition
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap00.html">Preface</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Exploratory data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap02.html">Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap03.html">Probability mass functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap04.html">Cumulative distribution functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap05.html">Modeling distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap06.html">Probability density functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap07.html">Relationships between variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap08.html">Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap09.html">Hypothesis testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap10.html">Linear least squares</a></li>

<li class="toctree-l1"><a class="reference internal" href="chap11.html">Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap12.html">Time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap13.html">Survival analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap14.html">Analytic methods</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/ThinkStats/tree/v3" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chap01.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Exploratory data analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-statistical-approach">A statistical approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-national-survey-of-family-growth">The National Survey of Family Growth</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-data">Importing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframes">DataFrames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation">Transformation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation">Validation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="exploratory-data-analysis">
<h1>Exploratory data analysis<a class="headerlink" href="#exploratory-data-analysis" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>


<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>

        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloaded &quot;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>


<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats2/raw/master/code/thinkstats2.py&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats2/raw/master/code/thinkplot.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats2/raw/master/code/nsfg.py&quot;</span><span class="p">)</span>

<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats2/raw/master/code/2002FemPreg.dct&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/AllenDowney/ThinkStats2/raw/master/code/2002FemPreg.dat.gz&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The thesis of this book is that data combined with practical methods can
answer questions and guide decisions under uncertainty.</p>
<p>As an example, I present a case study motivated by a question I heard
when my wife and I were expecting our first child: do first babies tend
to arrive late?</p>
<p>If you Google this question, you will find plenty of discussion. Some
people claim it’s true, others say it’s a myth, and some people say it’s
the other way around: first babies come early.</p>
<p>In many of these discussions, people provide data to support their
claims. I found many examples like these:</p>
<blockquote>
<div><p>“My two friends that have given birth recently to their first babies,
BOTH went almost 2 weeks overdue before going into labour or being
induced.”</p>
<p>“My first one came 2 weeks late and now I think the second one is
going to come out two weeks early!!”</p>
<p>“I don’t think that can be true because my sister was my mother’s
first and she was early, as with many of my cousins.”</p>
</div></blockquote>
<p>Reports like these are called <strong>anecdotal evidence</strong> because they are
based on data that is unpublished and usually personal. In casual
conversation, there is nothing wrong with anecdotes, so I don’t mean to
pick on the people I quoted.</p>
<p>But we might want evidence that is more persuasive and an answer that is
more reliable. By those standards, anecdotal evidence usually fails,
because:</p>
<ul class="simple">
<li><p>Small number of observations: If pregnancy length is longer for
first babies, the difference is probably small compared to natural
variation. In that case, we might have to compare a large number of
pregnancies to be sure that a difference exists.</p></li>
<li><p>Selection bias: People who join a discussion of this question might
be interested because their first babies were late. In that case the
process of selecting data would bias the results.</p></li>
<li><p>Confirmation bias: People who believe the claim might be more likely
to contribute examples that confirm it. People who doubt the claim
are more likely to cite counterexamples.</p></li>
<li><p>Inaccuracy: Anecdotes are often personal stories, and often
misremembered, misrepresented, repeated inaccurately, etc.</p></li>
</ul>
<p>So how can we do better?</p>
<section id="a-statistical-approach">
<h2>A statistical approach<a class="headerlink" href="#a-statistical-approach" title="Link to this heading">#</a></h2>
<p>To address the limitations of anecdotes, we will use the tools of
statistics, which include:</p>
<ul class="simple">
<li><p>Data collection: We will use data from a large national survey that
was designed explicitly with the goal of generating statistically
valid inferences about the U.S. population.</p></li>
<li><p>Descriptive statistics: We will generate statistics that summarize
the data concisely, and evaluate different ways to visualize data.</p></li>
<li><p>Exploratory data analysis: We will look for patterns, differences,
and other features that address the questions we are interested in.
At the same time we will check for inconsistencies and identify
limitations.</p></li>
<li><p>Estimation: We will use data from a sample to estimate
characteristics of the general population.</p></li>
<li><p>Hypothesis testing: Where we see apparent effects, like a difference
between two groups, we will evaluate whether the effect might have
happened by chance.</p></li>
</ul>
<p>By performing these steps with care to avoid pitfalls, we can reach
conclusions that are more justifiable and more likely to be correct.</p>
</section>
<section id="the-national-survey-of-family-growth">
<h2>The National Survey of Family Growth<a class="headerlink" href="#the-national-survey-of-family-growth" title="Link to this heading">#</a></h2>
<p>Since 1973 the U.S. Centers for Disease Control and Prevention (CDC)
have conducted the National Survey of Family Growth (NSFG), which is
intended to gather “information on family life, marriage and divorce,
pregnancy, infertility, use of contraception, and men’s and women’s
health. The survey results are used…to plan health services and health
education programs, and to do statistical studies of families,
fertility, and health.” See <a class="reference external" href="http://cdc.gov/nchs/nsfg.htm">http://cdc.gov/nchs/nsfg.htm</a>.</p>
<p>We will use data collected by this survey to investigate whether first
babies tend to come late, and other questions. In order to use this data
effectively, we have to understand the design of the study.</p>
<p>The NSFG is a <strong>cross-sectional</strong> study, which means that it captures a
snapshot of a group at a point in time. The most common alternative is a
<strong>longitudinal</strong> study, which observes a group repeatedly over a period
of time.</p>
<p>The NSFG has been conducted seven times; each deployment is called a
<strong>cycle</strong>. We will use data from Cycle 6, which was conducted from
January 2002 to March 2003.</p>
<p>The goal of the survey is to draw conclusions about a <strong>population</strong>;
the target population of the NSFG is people in the United States aged
15-44. Ideally surveys would collect data from every member of the
population, but that’s seldom possible. Instead we collect data from a
subset of the population called a <strong>sample</strong>. The people who participate
in a survey are called <strong>respondents</strong>.</p>
<p>In general, cross-sectional studies are meant to be <strong>representative</strong>,
which means that every member of the target population has an equal
chance of participating. That ideal is hard to achieve in practice, but
people who conduct surveys come as close as they can.</p>
<p>The NSFG is not representative; instead it is deliberately
<strong>oversampled</strong>. The designers of the study recruited three
groups—Hispanics, African-Americans and teenagers—at rates higher
than their representation in the U.S. population, in order to make sure
that the number of respondents in each of these groups is large enough
to draw valid statistical inferences.</p>
<p>Of course, the drawback of oversampling is that it is not as easy to
draw conclusions about the general population based on statistics from
the survey. We will come back to this point later.</p>
<p>When working with this kind of data, it is important to be familiar with
the <strong>codebook</strong>, which documents the design of the study, the survey
questions, and the encoding of the responses. The codebook and user’s
guide for the NSFG data are available from
<a class="reference external" href="http://www.cdc.gov/nchs/nsfg/nsfg_cycle6.htm">http://www.cdc.gov/nchs/nsfg/nsfg_cycle6.htm</a></p>
</section>
<section id="importing-the-data">
<h2>Importing the data<a class="headerlink" href="#importing-the-data" title="Link to this heading">#</a></h2>
<p>The code and data used in this book are available from
<a class="github reference external" href="https://github.com/AllenDowney/ThinkStats2">AllenDowney/ThinkStats2</a>. For information about
downloading and working with this code, see
Section <a class="reference internal" href="#code"><span class="xref myst">[code]</span></a>{reference-type=“ref” reference=“code”}.</p>
<p>Once you download the code, you should have a file called
<code class="docutils literal notranslate"><span class="pre">ThinkStats2/code/nsfg.py</span></code>. If you run it, it should read a data file,
run some tests, and print a message like, “All tests passed.”</p>
<p>Let’s see what it does. Pregnancy data from Cycle 6 of the NSFG is in a
file called <code class="docutils literal notranslate"><span class="pre">2002FemPreg.dat.gz</span></code>; it is a gzip-compressed data file in
plain text (ASCII), with fixed width columns. Each line in the file is a
<strong>record</strong> that contains data about one pregnancy.</p>
<p>The format of the file is documented in <code class="docutils literal notranslate"><span class="pre">2002FemPreg.dct</span></code>, which is a
Stata dictionary file. Stata is a statistical software system; a
“dictionary” in this context is a list of variable names, types, and
indices that identify where in each line to find each variable.</p>
<p>For example, here are a few lines from <code class="docutils literal notranslate"><span class="pre">2002FemPreg.dct</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">infile</span> <span class="n">dictionary</span> <span class="p">{</span>
  <span class="n">_column</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="n">str12</span>  <span class="n">caseid</span>    <span class="o">%</span><span class="mi">12</span><span class="n">s</span>  <span class="s2">&quot;RESPONDENT ID NUMBER&quot;</span>
  <span class="n">_column</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="n">byte</span>   <span class="n">pregordr</span>   <span class="o">%</span><span class="mi">2</span><span class="n">f</span>  <span class="s2">&quot;PREGNANCY ORDER (NUMBER)&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This dictionary describes two variables: <code class="docutils literal notranslate"><span class="pre">caseid</span></code> is a 12-character
string that represents the respondent ID; <code class="docutils literal notranslate"><span class="pre">pregordr</span></code> is a one-byte
integer that indicates which pregnancy this record describes for this
respondent.</p>
<p>The code you downloaded includes <code class="docutils literal notranslate"><span class="pre">thinkstats2.py</span></code>, which is a Python
module that contains many classes and functions used in this book,
including functions that read the Stata dictionary and the NSFG data
file. Here’s how they are used in <code class="docutils literal notranslate"><span class="pre">nsfg.py</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thinkstats2</span> <span class="kn">import</span> <span class="n">ReadStataDct</span>

<span class="k">def</span> <span class="nf">ReadFemPreg</span><span class="p">(</span><span class="n">dct_file</span><span class="o">=</span><span class="s1">&#39;2002FemPreg.dct&#39;</span><span class="p">,</span>
                <span class="n">dat_file</span><span class="o">=</span><span class="s1">&#39;2002FemPreg.dat.gz&#39;</span><span class="p">):</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="n">ReadStataDct</span><span class="p">(</span><span class="n">dct_file</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">dct</span><span class="o">.</span><span class="n">ReadFixedWidth</span><span class="p">(</span><span class="n">dat_file</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">)</span>
    <span class="n">CleanFemPreg</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ReadStataDct</span></code> takes the name of the dictionary file and returns <code class="docutils literal notranslate"><span class="pre">dct</span></code>,
a <code class="docutils literal notranslate"><span class="pre">FixedWidthVariables</span></code> object that contains the information from the
dictionary file. <code class="docutils literal notranslate"><span class="pre">dct</span></code> provides <code class="docutils literal notranslate"><span class="pre">ReadFixedWidth</span></code>, which reads the data
file.</p>
</section>
<section id="dataframes">
<h2>DataFrames<a class="headerlink" href="#dataframes" title="Link to this heading">#</a></h2>
<p>The result of <code class="docutils literal notranslate"><span class="pre">ReadFixedWidth</span></code> is a DataFrame, which is the fundamental
data structure provided by pandas, which is a Python data and statistics
package we’ll use throughout this book. A DataFrame contains a row for
each record, in this case one row per pregnancy, and a column for each
variable.</p>
<p>In addition to the data, a DataFrame also contains the variable names
and their types, and it provides methods for accessing and modifying the
data.</p>
<p>If you print <code class="docutils literal notranslate"><span class="pre">preg</span></code> you get a truncated view of the rows and columns, and
the shape of the DataFrame, which is 13593 rows/records and 244
columns/variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nsfg</span>
<span class="n">preg</span> <span class="o">=</span> <span class="n">nsfg</span><span class="o">.</span><span class="n">ReadFemPreg</span><span class="p">()</span>
<span class="n">preg</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/downey/ThinkStats/soln/nsfg.py:68: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df.birthwgt_lb.replace(na_vals, np.nan, inplace=True)
/home/downey/ThinkStats/soln/nsfg.py:69: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df.birthwgt_oz.replace(na_vals, np.nan, inplace=True)
/home/downey/ThinkStats/soln/nsfg.py:70: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df.hpagelb.replace(na_vals, np.nan, inplace=True)
/home/downey/ThinkStats/soln/nsfg.py:72: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df.babysex.replace([7, 9], np.nan, inplace=True)
/home/downey/ThinkStats/soln/nsfg.py:73: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df.nbrnaliv.replace([9], np.nan, inplace=True)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>caseid</th>
      <th>pregordr</th>
      <th>howpreg_n</th>
      <th>howpreg_p</th>
      <th>moscurrp</th>
      <th>nowprgdk</th>
      <th>pregend1</th>
      <th>pregend2</th>
      <th>nbrnaliv</th>
      <th>multbrth</th>
      <th>...</th>
      <th>laborfor_i</th>
      <th>religion_i</th>
      <th>metro_i</th>
      <th>basewgt</th>
      <th>adj_mod_basewgt</th>
      <th>finalwgt</th>
      <th>secu_p</th>
      <th>sest</th>
      <th>cmintvw</th>
      <th>totalwgt_lb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3410.389399</td>
      <td>3869.349602</td>
      <td>6448.271112</td>
      <td>2</td>
      <td>9</td>
      <td>NaN</td>
      <td>8.8125</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3410.389399</td>
      <td>3869.349602</td>
      <td>6448.271112</td>
      <td>2</td>
      <td>9</td>
      <td>NaN</td>
      <td>7.8750</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7226.301740</td>
      <td>8567.549110</td>
      <td>12999.542264</td>
      <td>2</td>
      <td>12</td>
      <td>NaN</td>
      <td>9.1250</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7226.301740</td>
      <td>8567.549110</td>
      <td>12999.542264</td>
      <td>2</td>
      <td>12</td>
      <td>NaN</td>
      <td>7.0000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7226.301740</td>
      <td>8567.549110</td>
      <td>12999.542264</td>
      <td>2</td>
      <td>12</td>
      <td>NaN</td>
      <td>6.1875</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13588</th>
      <td>12571</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4670.540953</td>
      <td>5795.692880</td>
      <td>6269.200989</td>
      <td>1</td>
      <td>78</td>
      <td>NaN</td>
      <td>6.1875</td>
    </tr>
    <tr>
      <th>13589</th>
      <td>12571</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4670.540953</td>
      <td>5795.692880</td>
      <td>6269.200989</td>
      <td>1</td>
      <td>78</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13590</th>
      <td>12571</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4670.540953</td>
      <td>5795.692880</td>
      <td>6269.200989</td>
      <td>1</td>
      <td>78</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13591</th>
      <td>12571</td>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4670.540953</td>
      <td>5795.692880</td>
      <td>6269.200989</td>
      <td>1</td>
      <td>78</td>
      <td>NaN</td>
      <td>7.5000</td>
    </tr>
    <tr>
      <th>13592</th>
      <td>12571</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4670.540953</td>
      <td>5795.692880</td>
      <td>6269.200989</td>
      <td>1</td>
      <td>78</td>
      <td>NaN</td>
      <td>7.5000</td>
    </tr>
  </tbody>
</table>
<p>13593 rows × 244 columns</p>
</div></div></div>
</div>
<p>The DataFrame is too big to display, so the output is truncated. The
last line reports the number of rows and columns.</p>
<p>The attribute <code class="docutils literal notranslate"><span class="pre">columns</span></code> returns a sequence of column names as Unicode
strings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;caseid&#39;, &#39;pregordr&#39;, &#39;howpreg_n&#39;, &#39;howpreg_p&#39;, &#39;moscurrp&#39;, &#39;nowprgdk&#39;,
       &#39;pregend1&#39;, &#39;pregend2&#39;, &#39;nbrnaliv&#39;, &#39;multbrth&#39;,
       ...
       &#39;laborfor_i&#39;, &#39;religion_i&#39;, &#39;metro_i&#39;, &#39;basewgt&#39;, &#39;adj_mod_basewgt&#39;,
       &#39;finalwgt&#39;, &#39;secu_p&#39;, &#39;sest&#39;, &#39;cmintvw&#39;, &#39;totalwgt_lb&#39;],
      dtype=&#39;object&#39;, length=244)
</pre></div>
</div>
</div>
</div>
<p>The result is an Index, which is another pandas data structure. We’ll
learn more about Index later, but for now we’ll treat it like a list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;pregordr&#39;
</pre></div>
</div>
</div>
</div>
<p>To access a column from a DataFrame, you can use the column name as a
key:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pregordr</span> <span class="o">=</span> <span class="n">preg</span><span class="p">[</span><span class="s1">&#39;pregordr&#39;</span><span class="p">]</span>
<span class="nb">type</span><span class="p">(</span><span class="n">pregordr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
</div>
<p>The result is a Series, yet another pandas data structure. A Series is
like a Python list with some additional features. When you print a
Series, you get the indices and the corresponding values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pregordr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        1
1        2
2        1
3        2
4        3
        ..
13588    1
13589    2
13590    3
13591    4
13592    5
Name: pregordr, Length: 13593, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>In this example the indices are integers from 0 to 13592, but in general
they can be any sortable type. The elements are also integers, but they
can be any type.</p>
<p>The last line includes the variable name, Series length, and data type;
<code class="docutils literal notranslate"><span class="pre">int64</span></code> is one of the types provided by NumPy. If you run this example
on a 32-bit machine you might see <code class="docutils literal notranslate"><span class="pre">int32</span></code>.</p>
<p>You can access the elements of a Series using integer indices and
slices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pregordr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pregordr</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2    1
3    2
4    3
Name: pregordr, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The result of the index operator is an <code class="docutils literal notranslate"><span class="pre">int64</span></code>; the result of the slice
is another Series.</p>
<p>You can also access the columns of a DataFrame using dot notation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pregordr</span> <span class="o">=</span> <span class="n">preg</span><span class="o">.</span><span class="n">pregordr</span>
</pre></div>
</div>
</div>
</div>
<p>This notation only works if the column name is a valid Python
identifier, so it has to begin with a letter, can’t contain spaces, etc.</p>
</section>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Link to this heading">#</a></h2>
<p>We have already seen two variables in the NSFG dataset, <code class="docutils literal notranslate"><span class="pre">caseid</span></code> and
<code class="docutils literal notranslate"><span class="pre">pregordr</span></code>, and we have seen that there are 244 variables in total. For
the explorations in this book, I use the following variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">caseid</span></code> is the integer ID of the respondent.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prglngth</span></code> is the integer duration of the pregnancy in weeks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outcome</span></code> is an integer code for the outcome of the pregnancy. The
code 1 indicates a live birth.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pregordr</span></code> is a pregnancy serial number; for example, the code for a
respondent’s first pregnancy is 1, for the second pregnancy is 2,
and so on.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">birthord</span></code> is a serial number for live births; the code for a
respondent’s first child is 1, and so on. For outcomes other than
live birth, this field is blank.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">birthwgt_lb</span></code> and <code class="docutils literal notranslate"><span class="pre">birthwgt_oz</span></code> contain the pounds and ounces parts
of the birth weight of the baby.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">agepreg</span></code> is the mother’s age at the end of the pregnancy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finalwgt</span></code> is the statistical weight associated with the respondent.
It is a floating-point value that indicates the number of people in
the U.S. population this respondent represents.</p></li>
</ul>
<p>If you read the codebook carefully, you will see that many of the
variables are <strong>recodes</strong>, which means that they are not part of the
<strong>raw data</strong> collected by the survey; they are calculated using the raw
data.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">prglngth</span></code> for live births is equal to the raw variable
<code class="docutils literal notranslate"><span class="pre">wksgest</span></code> (weeks of gestation) if it is available; otherwise it is
estimated using <code class="docutils literal notranslate"><span class="pre">mosgest</span> <span class="pre">*</span> <span class="pre">4.33</span></code> (months of gestation times the average
number of weeks in a month).</p>
<p>Recodes are often based on logic that checks the consistency and
accuracy of the data. In general it is a good idea to use recodes when
they are available, unless there is a compelling reason to process the
raw data yourself.</p>
</section>
<section id="transformation">
<h2>Transformation<a class="headerlink" href="#transformation" title="Link to this heading">#</a></h2>
<p>When you import data like this, you often have to check for errors, deal
with special values, convert data into different formats, and perform
calculations. These operations are called <strong>data cleaning</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nsfg.py</span></code> includes <code class="docutils literal notranslate"><span class="pre">CleanFemPreg</span></code>, a function that cleans the variables
I am planning to use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">CleanFemPreg</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">agepreg</span> <span class="o">/=</span> <span class="mf">100.0</span>

    <span class="n">na_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;birthwgt_lb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">birthwgt_lb</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">na_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;birthwgt_oz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">birthwgt_oz</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">na_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;totalwgt_lb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">birthwgt_lb</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">birthwgt_oz</span> <span class="o">/</span> <span class="mf">16.0</span>    
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">agepreg</span></code> contains the mother’s age at the end of the pregnancy. In the
data file, <code class="docutils literal notranslate"><span class="pre">agepreg</span></code> is encoded as an integer number of centiyears. So
the first line divides each element of <code class="docutils literal notranslate"><span class="pre">agepreg</span></code> by 100, yielding a
floating-point value in years.</p>
<p><code class="docutils literal notranslate"><span class="pre">birthwgt_lb</span></code> and <code class="docutils literal notranslate"><span class="pre">birthwgt_oz</span></code> contain the weight of the baby, in
pounds and ounces, for pregnancies that end in live birth. In addition
it uses several special codes:</p>
<p>Special values encoded as numbers are <em>dangerous</em> because if they are
not handled properly, they can generate bogus results, like a 99-pound
baby. The <code class="docutils literal notranslate"><span class="pre">replace</span></code> method replaces these values with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>, a
special floating-point value that represents “not a number.”</p>
<p>As part of the IEEE floating-point standard, all mathematical operations
return <code class="docutils literal notranslate"><span class="pre">nan</span></code> if either argument is <code class="docutils literal notranslate"><span class="pre">nan</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">/</span> <span class="mf">100.0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
</pre></div>
</div>
</div>
</div>
<p>So computations with <code class="docutils literal notranslate"><span class="pre">nan</span></code> tend to do the right thing, and most pandas
functions handle <code class="docutils literal notranslate"><span class="pre">nan</span></code> appropriately. But dealing with missing data will
be a recurring issue.</p>
<p>The last line of <code class="docutils literal notranslate"><span class="pre">CleanFemPreg</span></code> creates a new column <code class="docutils literal notranslate"><span class="pre">totalwgt_lb</span></code> that
combines pounds and ounces into a single quantity, in pounds.</p>
<p>One important note: when you add a new column to a DataFrame, you must
use dictionary syntax, like this</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CORRECT</span>
<span class="n">preg</span><span class="p">[</span><span class="s1">&#39;totalwgt_lb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preg</span><span class="o">.</span><span class="n">birthwgt_lb</span> <span class="o">+</span> <span class="n">preg</span><span class="o">.</span><span class="n">birthwgt_oz</span> <span class="o">/</span> <span class="mf">16.0</span> 
</pre></div>
</div>
</div>
</div>
<p>Not dot notation, like this:</p>
<p>The version with dot notation adds an attribute to the DataFrame object,
but that attribute is not treated as a new column.</p>
</section>
<section id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Link to this heading">#</a></h2>
<p>When data is exported from one software environment and imported into
another, errors might be introduced. And when you are getting familiar
with a new dataset, you might interpret data incorrectly or introduce
other misunderstandings. If you take time to validate the data, you can
save time later and avoid errors.</p>
<p>One way to validate data is to compute basic statistics and compare them
with published results. For example, the NSFG codebook includes tables
that summarize each variable. Here is the table for <code class="docutils literal notranslate"><span class="pre">outcome</span></code>, which
encodes the outcome of each pregnancy:</p>
<p>The Series class provides a method, <code class="docutils literal notranslate"><span class="pre">value_counts</span></code>, that counts the
number of times each value appears. If we select the <code class="docutils literal notranslate"><span class="pre">outcome</span></code> Series
from the DataFrame, we can use <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> to compare with the
published data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="o">.</span><span class="n">outcome</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>outcome
1    9148
2    1862
3     120
4    1921
5     190
6     352
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The result of <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> is a Series; <code class="docutils literal notranslate"><span class="pre">sort_index()</span></code> sorts the
Series by index, so the values appear in order.</p>
<p>Comparing the results with the published table, it looks like the values
in <code class="docutils literal notranslate"><span class="pre">outcome</span></code> are correct. Similarly, here is the published table for
<code class="docutils literal notranslate"><span class="pre">birthwgt_lb</span></code></p>
<p>And here are the value counts:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="o">.</span><span class="n">birthwgt_lb</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>birthwgt_lb
0.0        8
1.0       40
2.0       53
3.0       98
4.0      229
5.0      697
6.0     2223
7.0     3049
8.0     1889
9.0      623
10.0     132
11.0      26
12.0      10
13.0       3
14.0       3
15.0       1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The counts for 6, 7, and 8 pounds check out, and if you add up the
counts for 0-5 and 9-95, they check out, too. But if you look more
closely, you will notice one value that has to be an error, a 51 pound
baby!</p>
<p>To deal with this error, I added a line to <code class="docutils literal notranslate"><span class="pre">CleanFemPreg</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">preg</span><span class="o">.</span><span class="n">birthwgt_lb</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;birthwgt_lb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<p>This statement replaces invalid values with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>. The attribute
<code class="docutils literal notranslate"><span class="pre">loc</span></code> provides several ways to select rows and columns from a DataFrame.
In this example, the first expression in brackets is the row indexer;
the second expression selects the column.</p>
<p>The expression <code class="docutils literal notranslate"><span class="pre">preg.birthwgt_lb</span> <span class="pre">&gt;</span> <span class="pre">20</span></code> yields a Series of type <code class="docutils literal notranslate"><span class="pre">bool</span></code>,
where True indicates that the condition is true. When a boolean Series
is used as an index, it selects only the elements that satisfy the
condition.</p>
</section>
<section id="interpretation">
<h2>Interpretation<a class="headerlink" href="#interpretation" title="Link to this heading">#</a></h2>
<p>To work with data effectively, you have to think on two levels at the
same time: the level of statistics and the level of context.</p>
<p>As an example, let’s look at the sequence of outcomes for a few
respondents. Because of the way the data files are organized, we have to
do some processing to collect the pregnancy data for each respondent.
Here’s a function that does that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MakePregMap</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">caseid</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">caseid</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
        <span class="n">d</span><span class="p">[</span><span class="n">caseid</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">df</span></code> is the DataFrame with pregnancy data. The <code class="docutils literal notranslate"><span class="pre">iteritems</span></code> method
enumerates the index (row number) and <code class="docutils literal notranslate"><span class="pre">caseid</span></code> for each pregnancy.</p>
<p><code class="docutils literal notranslate"><span class="pre">d</span></code> is a dictionary that maps from each case ID to a list of indices. If
you are not familiar with <code class="docutils literal notranslate"><span class="pre">defaultdict</span></code>, it is in the Python
<code class="docutils literal notranslate"><span class="pre">collections</span></code> module. Using <code class="docutils literal notranslate"><span class="pre">d</span></code>, we can look up a respondent and get the
indices of that respondent’s pregnancies.</p>
<p>This example looks up one respondent and prints a list of outcomes for
her pregnancies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">caseid</span> <span class="o">=</span> <span class="mi">10229</span>
<span class="n">preg_map</span> <span class="o">=</span> <span class="n">nsfg</span><span class="o">.</span><span class="n">MakePregMap</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">preg_map</span><span class="p">[</span><span class="n">caseid</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">outcome</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([4, 4, 4, 4, 4, 4, 1])
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">indices</span></code> is the list of indices for pregnancies corresponding to
respondent <code class="docutils literal notranslate"><span class="pre">10229</span></code>.</p>
<p>Using this list as an index into <code class="docutils literal notranslate"><span class="pre">df.outcome</span></code> selects the indicated rows
and yields a Series. Instead of printing the whole Series, I selected
the <code class="docutils literal notranslate"><span class="pre">values</span></code> attribute, which is a NumPy array.</p>
<p>The outcome code <code class="docutils literal notranslate"><span class="pre">1</span></code> indicates a live birth. Code <code class="docutils literal notranslate"><span class="pre">4</span></code> indicates a
miscarriage; that is, a pregnancy that ended spontaneously, usually with
no known medical cause.</p>
<p>Statistically this respondent is not unusual. Miscarriages are common
and there are other respondents who reported as many or more.</p>
<p>But remembering the context, this data tells the story of a woman who
was pregnant six times, each time ending in miscarriage. Her seventh and
most recent pregnancy ended in a live birth. If we consider this data
with empathy, it is natural to be moved by the story it tells.</p>
<p>Each record in the NSFG dataset represents a person who provided honest
answers to many personal and difficult questions. We can use this data
to answer statistical questions about family life, reproduction, and
health. At the same time, we have an obligation to consider the people
represented by the data, and to afford them respect and gratitude.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>Select the <code class="docutils literal notranslate"><span class="pre">birthord</span></code> column, print the value counts, and compare to results published in the <a class="reference external" href="https://ftp.cdc.gov/pub/Health_Statistics/NCHS/Dataset_Documentation/NSFG/Cycle6Codebook-Pregnancy.pdf">codebook</a></p>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">isnull</span></code> to count the number of nans.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="o">.</span><span class="n">birthord</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4445
</pre></div>
</div>
</div>
</div>
<p>Select the <code class="docutils literal notranslate"><span class="pre">prglngth</span></code> column, print the value counts, and compare to results published in the <a class="reference external" href="https://ftp.cdc.gov/pub/Health_Statistics/NCHS/Dataset_Documentation/NSFG/Cycle6Codebook-Pregnancy.pdf">codebook</a></p>
<p>To compute the mean of a column, you can invoke the <code class="docutils literal notranslate"><span class="pre">mean</span></code> method on a Series.  For example, here is the mean birthweight in pounds:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="o">.</span><span class="n">totalwgt_lb</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.265628457623368
</pre></div>
</div>
</div>
</div>
<p>Create a new column named <tt>totalwgt_kg</tt> that contains birth weight in kilograms.  Compute its mean.  Remember that when you create a new column, you have to use dictionary syntax, not dot notation.</p>
<p><code class="docutils literal notranslate"><span class="pre">nsfg.py</span></code> also provides <code class="docutils literal notranslate"><span class="pre">ReadFemResp</span></code>, which reads the female respondents file and returns a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats2/raw/master/code/2002FemResp.dct&quot;</span><span class="p">)</span>
<span class="n">download</span><span class="p">(</span><span class="s2">&quot;https://github.com/AllenDowney/ThinkStats2/raw/master/code/2002FemResp.dat.gz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloaded 2002FemResp.dct
Downloaded 2002FemResp.dat.gz
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp</span> <span class="o">=</span> <span class="n">nsfg</span><span class="o">.</span><span class="n">ReadFemResp</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> provides a method <code class="docutils literal notranslate"><span class="pre">head</span></code> that displays the first five rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>caseid</th>
      <th>rscrinf</th>
      <th>rdormres</th>
      <th>rostscrn</th>
      <th>rscreenhisp</th>
      <th>rscreenrace</th>
      <th>age_a</th>
      <th>age_r</th>
      <th>cmbirth</th>
      <th>agescrn</th>
      <th>...</th>
      <th>pubassis_i</th>
      <th>basewgt</th>
      <th>adj_mod_basewgt</th>
      <th>finalwgt</th>
      <th>secu_r</th>
      <th>sest</th>
      <th>cmintvw</th>
      <th>cmlstyr</th>
      <th>screentime</th>
      <th>intvlngth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2298</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>1</td>
      <td>5.0</td>
      <td>27</td>
      <td>27</td>
      <td>902</td>
      <td>27</td>
      <td>...</td>
      <td>0</td>
      <td>3247.916977</td>
      <td>5123.759559</td>
      <td>5556.717241</td>
      <td>2</td>
      <td>18</td>
      <td>1234</td>
      <td>1222</td>
      <td>18:26:36</td>
      <td>110.492667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5012</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>5</td>
      <td>5.0</td>
      <td>42</td>
      <td>42</td>
      <td>718</td>
      <td>42</td>
      <td>...</td>
      <td>0</td>
      <td>2335.279149</td>
      <td>2846.799490</td>
      <td>4744.191350</td>
      <td>2</td>
      <td>18</td>
      <td>1233</td>
      <td>1221</td>
      <td>16:30:59</td>
      <td>64.294000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11586</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>5</td>
      <td>5.0</td>
      <td>43</td>
      <td>43</td>
      <td>708</td>
      <td>43</td>
      <td>...</td>
      <td>0</td>
      <td>2335.279149</td>
      <td>2846.799490</td>
      <td>4744.191350</td>
      <td>2</td>
      <td>18</td>
      <td>1234</td>
      <td>1222</td>
      <td>18:19:09</td>
      <td>75.149167</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6794</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>5.0</td>
      <td>15</td>
      <td>15</td>
      <td>1042</td>
      <td>15</td>
      <td>...</td>
      <td>0</td>
      <td>3783.152221</td>
      <td>5071.464231</td>
      <td>5923.977368</td>
      <td>2</td>
      <td>18</td>
      <td>1234</td>
      <td>1222</td>
      <td>15:54:43</td>
      <td>28.642833</td>
    </tr>
    <tr>
      <th>4</th>
      <td>616</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>1</td>
      <td>5.0</td>
      <td>20</td>
      <td>20</td>
      <td>991</td>
      <td>20</td>
      <td>...</td>
      <td>0</td>
      <td>5341.329968</td>
      <td>6437.335772</td>
      <td>7229.128072</td>
      <td>2</td>
      <td>18</td>
      <td>1233</td>
      <td>1221</td>
      <td>14:19:44</td>
      <td>69.502667</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 3087 columns</p>
</div></div></div>
</div>
<p>Select the <code class="docutils literal notranslate"><span class="pre">age_r</span></code> column from <code class="docutils literal notranslate"><span class="pre">resp</span></code> and print the value counts.  How old are the youngest and oldest respondents?</p>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">caseid</span></code> to match up rows from <code class="docutils literal notranslate"><span class="pre">resp</span></code> and <code class="docutils literal notranslate"><span class="pre">preg</span></code>.  For example, we can select the row from <code class="docutils literal notranslate"><span class="pre">resp</span></code> for <code class="docutils literal notranslate"><span class="pre">caseid</span></code> 2298 like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">resp</span><span class="p">[</span><span class="n">resp</span><span class="o">.</span><span class="n">caseid</span><span class="o">==</span><span class="mi">2298</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>caseid</th>
      <th>rscrinf</th>
      <th>rdormres</th>
      <th>rostscrn</th>
      <th>rscreenhisp</th>
      <th>rscreenrace</th>
      <th>age_a</th>
      <th>age_r</th>
      <th>cmbirth</th>
      <th>agescrn</th>
      <th>...</th>
      <th>pubassis_i</th>
      <th>basewgt</th>
      <th>adj_mod_basewgt</th>
      <th>finalwgt</th>
      <th>secu_r</th>
      <th>sest</th>
      <th>cmintvw</th>
      <th>cmlstyr</th>
      <th>screentime</th>
      <th>intvlngth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2298</td>
      <td>1</td>
      <td>5</td>
      <td>5</td>
      <td>1</td>
      <td>5.0</td>
      <td>27</td>
      <td>27</td>
      <td>902</td>
      <td>27</td>
      <td>...</td>
      <td>0</td>
      <td>3247.916977</td>
      <td>5123.759559</td>
      <td>5556.717241</td>
      <td>2</td>
      <td>18</td>
      <td>1234</td>
      <td>1222</td>
      <td>18:26:36</td>
      <td>110.492667</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 3087 columns</p>
</div></div></div>
</div>
<p>And we can get the corresponding rows from <code class="docutils literal notranslate"><span class="pre">preg</span></code> like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preg</span><span class="p">[</span><span class="n">preg</span><span class="o">.</span><span class="n">caseid</span><span class="o">==</span><span class="mi">2298</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>caseid</th>
      <th>pregordr</th>
      <th>howpreg_n</th>
      <th>howpreg_p</th>
      <th>moscurrp</th>
      <th>nowprgdk</th>
      <th>pregend1</th>
      <th>pregend2</th>
      <th>nbrnaliv</th>
      <th>multbrth</th>
      <th>...</th>
      <th>religion_i</th>
      <th>metro_i</th>
      <th>basewgt</th>
      <th>adj_mod_basewgt</th>
      <th>finalwgt</th>
      <th>secu_p</th>
      <th>sest</th>
      <th>cmintvw</th>
      <th>totalwgt_lb</th>
      <th>totalwgt_kg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2610</th>
      <td>2298</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>3247.916977</td>
      <td>5123.759559</td>
      <td>5556.717241</td>
      <td>2</td>
      <td>18</td>
      <td>NaN</td>
      <td>6.8750</td>
      <td>3.125000</td>
    </tr>
    <tr>
      <th>2611</th>
      <td>2298</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>3247.916977</td>
      <td>5123.759559</td>
      <td>5556.717241</td>
      <td>2</td>
      <td>18</td>
      <td>NaN</td>
      <td>5.5000</td>
      <td>2.500000</td>
    </tr>
    <tr>
      <th>2612</th>
      <td>2298</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>3247.916977</td>
      <td>5123.759559</td>
      <td>5556.717241</td>
      <td>2</td>
      <td>18</td>
      <td>NaN</td>
      <td>4.1875</td>
      <td>1.903409</td>
    </tr>
    <tr>
      <th>2613</th>
      <td>2298</td>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>3247.916977</td>
      <td>5123.759559</td>
      <td>5556.717241</td>
      <td>2</td>
      <td>18</td>
      <td>NaN</td>
      <td>6.8750</td>
      <td>3.125000</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 245 columns</p>
</div></div></div>
</div>
<p>How old is the respondent with <code class="docutils literal notranslate"><span class="pre">caseid</span></code> 1?</p>
<p>What are the pregnancy lengths for the respondent with <code class="docutils literal notranslate"><span class="pre">caseid</span></code> 2298?</p>
<p>What was the birthweight of the first baby born to the respondent with <code class="docutils literal notranslate"><span class="pre">caseid</span></code> 5013?</p>
<p>Examples and Exercises from Think Stats, 2nd Edition</p>
<p><a class="reference external" href="http://thinkstats2.com">http://thinkstats2.com</a></p>
<p>Copyright 2016 Allen B. Downey</p>
<p>MIT License: <a class="reference external" href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="chap00.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Preface</p>
      </div>
    </a>
    <a class="right-next"
       href="chap02.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Distributions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-statistical-approach">A statistical approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-national-survey-of-family-growth">The National Survey of Family Growth</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-data">Importing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataframes">DataFrames</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformation">Transformation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation">Validation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>